var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))(function(i,o){function s(t){try{_(a.next(t))}catch(e){o(e)}}function r(t){try{_(a["throw"](t))}catch(e){o(e)}}function _(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,r)}_((a=a.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return a([t,e])}}function a(n){if(i)throw new TypeError("Generator is already executing.");for(;_;)try{if(i=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return _.label++,{value:n[1],done:!1};case 5:_.label++,o=n[1],n=[0];continue;case 7:n=_.ops.pop(),_.trys.pop();continue;default:if(s=_.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){_=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){_.label=n[1];break}if(6===n[0]&&_.label<s[1]){_.label=s[1],s=n;break}if(s&&_.label<s[2]){_.label=s[2],_.ops.push(n);break}s[2]&&_.ops.pop(),_.trys.pop();continue}n=e.call(t,_)}catch(a){n=[6,a],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,r,_={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},Controller=function(){function t(t){this.commandList=new Object,this.channel=t}return t.prototype.addCommand=function(t,e,n){this.commandList.hasOwnProperty(t)||(this.commandList[t]=[n,e])},t.prototype.executeCommand=function(t,e){return null!=this.commandList[t]?this.commandList[t][1].call(this.commandList[t][0],e):null},t}();__reflect(Controller.prototype,"Controller");var DataProxy=function(){function t(t){this.funcListObj=new Object,this.channel=t}return t.prototype.addDataFunc=function(t,e,n){this.funcListObj.hasOwnProperty(t)||(this.funcListObj[t]=[]),this.funcListObj[t].push(new Array(e,n))},t.prototype.executeCommand=function(t,e){var n=this.funcListObj[t];for(var a in n)for(var i=n[a],o=0;o<i.length;o++){var s=i[0],r=i[1];s&&s.call(r,e)}},t}();__reflect(DataProxy.prototype,"DataProxy");var BaseView=function(t){function e(e){var n=t.call(this)||this;return n.channel=e,n}return __extends(e,t),e.prototype.init=function(){},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.viewName=null},e}(egret.Sprite);__reflect(BaseView.prototype,"BaseView");var RoleInfoModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,t)},t}();__reflect(RoleInfoModuleLogic.prototype,"RoleInfoModuleLogic");var BairenNiuniuBattleController=function(t){function e(e){var n=t.call(this,e)||this;return n.addCommand(ConstData.BATTLE_BAI_NIU_MATCH_PLAYERS,n.matchPlayers,n),n.addCommand(ConstData.BATTLE_BAI_NIU_CALL_LANDlORD,n.shangZhuang,n),n.addCommand(ConstData.BATTLE_BAI_NIU_GRAB_SUCCESS,n.grabSuccess,n),n.addCommand(ConstData.BATTLE_BAI_NIU_BROAD_XIAZHU,n.broadXiaZhu,n),n.addCommand(ConstData.BATTLE_BAI_NIU_XIAZHU,n.xiaZhu,n),n.addCommand(ConstData.BATTLE_BAI_NIU_JIESUAN,n.jiesuan,n),n.addCommand(ConstData.BATTLE_BAI_NIU_CLEAR,n.clear,n),n.addCommand(ConstData.BATTLE_BAI_NIU_RECON_GAME,n.reconName,n),n.addCommand(ConstData.BATTLE_BAI_NIU_SCORE_CHANGE,n.onScoreChange,n),n.addCommand(ConstData.BATTLE_BAI_NIU_QIANG_ZHUANG_BROAD,n.onScoreChange,n),n.addCommand(ConstData.BATTLE_BAI_NIU_CLOSE_MATCH_TIMER,n.closeMatchTimer,n),n.addCommand(ConstData.BATTLE_BAI_NIU_INVAILD,n.invaild,n),n.addCommand(ConstData.BATTLE_BAI_NIU_RETURN_GROUND,n.returnGround,n),n.addCommand(ConstData.BATTLE_BAI_NIU_ROOM_ROLE_CHANGE,n.roomRoleChange,n),n}return __extends(e,t),e.prototype.init=function(){},e.prototype.reconName=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.reconGame(t)},e.prototype.matchPlayers=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);t.matchPlayers()},e.prototype.roomRoleChange=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.roomRoleChange(t)},e.prototype.shangZhuang=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.shangZhuang(t)},e.prototype.grabSuccess=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.grabSuccess(t)},e.prototype.broadXiaZhu=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.broadXiaZhu(t)},e.prototype.xiaZhu=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.xiaZhu(t)},e.prototype.onScoreChange=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.onScoreChange(t)},e.prototype.closeMatchTimer=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);t.closeMatchTimer()},e.prototype.invaild=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);t.invaild()},e.prototype.returnGround=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);t.returnGround()},e.prototype.clear=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.clear()},e.prototype.jiesuan=function(t){void 0===t&&(t=null);var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BAIREN_NIUNIU_BATTLE_VIEW);e.setCard(0,t)},e}(Controller);__reflect(BairenNiuniuBattleController.prototype,"BairenNiuniuBattleController");var BattleController=function(t){function e(e){var n=t.call(this,e)||this;return n.addCommand(ConstData.BATTLE_MATCH_PLAYERS,n.matchPlayers,n),n.addCommand(ConstData.BATTLE_SET_CARD,n.setCard,n),n.addCommand(ConstData.BATTLE_JIA_BEI,n.isJiabei,n),n.addCommand(ConstData.BATTLE_JIA_BEI_RESULT,n.jiabeiResult,n),n.addCommand(ConstData.BATTLE_GRAB_SUCCESS,n.grablandLordSuccess,n),n.addCommand(ConstData.BATTLE_CALL_LANDlORD,n.callLandLord,n),n.addCommand(ConstData.BATTLE_ROLE_GRAB,n.roleGrab,n),n.addCommand(ConstData.BATTLE_PLAY_GAME,n.onPlayGame,n),n.addCommand(ConstData.BATTLE_GAME_OVER,n.gameOver,n),n.addCommand(ConstData.BATTLE_ON_PLAY_CARD,n.onPlayCard,n),n.addCommand(ConstData.BATTLE_ON_PASS_CARD,n.onPassCard,n),n.addCommand(ConstData.BATTLE_CLEAR,n.clear,n),n.addCommand(ConstData.BATTLE_RECON_GAME,n.reconName,n),n.addCommand(ConstData.BATTLE_SCORE_CHANGE,n.onScoreChange,n),n.addCommand(ConstData.BATTLE_PLAY_ERROR,n.playError,n),n.addCommand(ConstData.BATTLE_CLOSE_MATCH_TIMER,n.closeMatchTimer,n),n.addCommand(ConstData.BATTLE_GET_CARDS,n.getCards,n),n.addCommand(ConstData.BATTLE_INVAILD,n.invaild,n),n.addCommand(ConstData.BATTLE_RETURN_GROUND,n.returnGround,n),n.addCommand(ConstData.BATTLE_JOIN_TABLE,n.joinTable,n),n.addCommand(ConstData.BATTLE_CHAT,n.onBattleChat,n),n}return __extends(e,t),e.prototype.init=function(){},e.prototype.reconName=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.reconGame(t)},e.prototype.setCard=function(t){void 0===t&&(t=null);var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.onMatchPlayerBack(t),e.setCard(t)},e.prototype.matchPlayers=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);t.matchPlayers()},e.prototype.joinTable=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);t.matchPlayers()},e.prototype.onBattleChat=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.onBattleChat(t)},e.prototype.grablandLordSuccess=function(t){void 0===t&&(t=null);var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.grabLandLordSuccess(t)},e.prototype.callLandLord=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.callLandLord(t)},e.prototype.roleGrab=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.roleGrab(t)},e.prototype.isJiabei=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.isJiabei(t)},e.prototype.jiabeiResult=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.jiabeiResult(t)},e.prototype.onScoreChange=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.onScoreChange(t)},e.prototype.playError=function(t){this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,[t.Msg,500,-1,536])},e.prototype.closeMatchTimer=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);t.closeMatchTimer()},e.prototype.getCards=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);t.getCards()},e.prototype.invaild=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);t.invaild()},e.prototype.returnGround=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);t.returnGround()},e.prototype.onPlayGame=function(t){void 0===t&&(t=null);var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.onPlayGame(t)},e.prototype.onPlayCard=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.onPlayCard(t)},e.prototype.onPassCard=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.onPassCard(t)},e.prototype.playCardError=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.playCardError(t)},e.prototype.clear=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.clear()},e.prototype.gameOver=function(t){void 0===t&&(t=null);var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.BATTLE_VIEW);e.gameOver(t)},e}(Controller);__reflect(BattleController.prototype,"BattleController");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function a(a){e.call(n,a,t)}if(RES.hasRes(t)){var i=RES.getRes(t);i?a(i):RES.getResAsync(t,a,this)}else RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GameController=function(t){function e(e){var n=t.call(this,e)||this;return n.addCommand(ConstData.GAME_INIT_GAME_LAYER,n.initGameLayer,n),n.addCommand(ConstData.GAME_GET_LAYER,n.getLayer,n),n.addCommand(ConstData.GAME_ENTER_GAME,n.enterGame,n),n.addCommand(ConstData.GAME_CLEAR_ALL_LAYER,n.clearAllLayer,n),n.addCommand(ConstData.GAME_SET_PLAYER,n.setPlayerData,n),n.addCommand(ConstData.GAME_DESTROY,n.destroy,n),n}return __extends(e,t),e.prototype.init=function(){},e.prototype.initGameLayer=function(){this._gameLayer=new GameLayer,this._gameLayer.init(),Game.instance.addChild(this._gameLayer)},e.prototype.getLayer=function(t){switch(void 0===t&&(t=""),t){case ConstData.UI_LAYER:return this._gameLayer.UILayer;case ConstData.ANIMATE_LAYER:return this._gameLayer.animateLayer;case ConstData.EFFECT_LAYER:return this._gameLayer.effectLayer;case ConstData.TOP_LAYER:return this._gameLayer.topLayer;default:return this._gameLayer}},e.prototype.setPlayerData=function(t){var e=Player.instance;for(var n in t)e[n]=t[n]},e.prototype.clearAllLayer=function(){this._gameLayer.clearAllLayer()},e.prototype.enterGame=function(){this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.BATTLE_VIEW,0,0,ConstData.UI_LAYER]),this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.GROUND_VIEW]),this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_MATCH_PLAYERS)},e.prototype.destroy=function(){this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_DESTROY_ALL_VIEW),Player.instance.destroy(),CardUtils.instance.destroy(),this.channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_DESTROY)},e}(Controller);__reflect(GameController.prototype,"GameController");var NetController=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this,e)||this;return n.sequence=1,n.callBackPool={},n.addCommand(ConstData.NET_CONNECT,n.connect,n),n.addCommand(ConstData.NET_CLOSE,n.close,n),n.addCommand(ConstData.NET_OVER_CLOSE,n.overClose,n),n.addCommand(ConstData.NET_READDATA,n.readData,n),n.addCommand(ConstData.NET_ADDLISTENER,n.addListener,n),n.addCommand(ConstData.NET_SENDDATA,n.sendData,n),n.addCommand(ConstData.NET_SHOWSTATE,n.showState,n),n.addCommand(ConstData.NET_CLEAR_HEART_BEAT,n.clearHeartBeat,n),n.addCommand(ConstData.NET_DESTROY,n.destroy,n),n.addCommand(ConstData.NET_LOGIN,n.login,n),n}return __extends(e,t),e.prototype.init=function(){this.ws=new WS(this.channel),this.dispatcher=new egret.EventDispatcher,this.addListener(NetCommands.MSG_TYPE_OF_CALL_SCORE),this.addListener(NetCommands.MSG_TYPE_OF_ROLE_GRAB),this.addListener(NetCommands.MSG_TYPE_OF_JIA_BEI),this.addListener(NetCommands.MSG_TYPE_OF_JIA_BEI_RESULT),this.addListener(NetCommands.MSG_TYPE_OF_SEND_BOTTOM_CARDS),this.addListener(NetCommands.MSG_TYPE_OF_SCORE_CHANGE),this.addListener(NetCommands.MSG_TYPE_OF_TIME_TICKER),this.addListener(NetCommands.MSG_TYPE_OF_PLAY_CARD_SUCCESS),this.addListener(NetCommands.TYPE_OF_TABLE_BRODCAST),this.addListener(NetCommands.MSG_TYPE_OF_PVP_SUCCESS),this.addListener(NetCommands.MSG_TYPE_OF_SEND_CARD),this.addListener(NetCommands.MSG_TYPE_OF_RECON_GAME),this.addListener(NetCommands.MSG_TYPE_OF_GET_CARDS),this.addListener(NetCommands.MSG_TYPE_OF_HEART_BEAT),this.addListener(NetCommands.MSG_TYPE_OF_PLAY_ERROR),this.addListener(NetCommands.MSG_TYPE_OF_GAME_OVER),this.addListener(NetCommands.NIUNIU_SEND_CARD),this.addListener(NetCommands.NIUNIU_CALL_SCORE),this.addListener(NetCommands.NIUNIU_QIANG_ZHUANG_BROAD),this.addListener(NetCommands.NIUNIU_ROLE_GRAB_ID),this.addListener(NetCommands.NIUNIU_ROLE_XIAZHU_BROAD),this.addListener(NetCommands.NIUNIU_ROLE_XIAZHU_RESULT),this.addListener(NetCommands.NIUNIU_JIESUAN),this.addListener(NetCommands.BAI_NIUNIU_ROLE_GRAB_ID),this.addListener(NetCommands.BAI_NIUNIU_ROLE_XIAZHU_BROAD),this.addListener(NetCommands.BAI_NIUNIU_ROLE_XIAZHU_RESULT),this.addListener(NetCommands.BAI_NIUNIU_JIESUAN)},e.prototype.login=function(){this.ws&&this.ws.login()},e.prototype.clearHeartBeat=function(){this.ws&&this.ws.clearHeartBeat()},e.prototype.connect=function(t){},e.prototype.close=function(){var t=new BaseMsg;t.MsgType=NetCommands.MSG_TYPE_WS_CLOSE,this.sendData([t]),this.clearHeartBeat(),this.ws&&this.ws.close()},e.prototype.overClose=function(){console.log("结算关闭了连接");var t=new BaseMsg;t.MsgType=NetCommands.MSG_TYPE_OF_OVER,this.sendData([t]),this.clearHeartBeat(),this.ws&&this.ws.close()},e.prototype.readData=function(t){var e=t.Seq;if(e){var n=this.callBackPool[e];n&&(n.callback.call(n.thisObj,t),this.callBackPool[e]=null),delete this.callBackPool[e]}else this.dispatcher.dispatchEventWith(t.MsgType,!1,t)},e.prototype.addListener=function(t){this.dispatcher.addEventListener(t,this.onReciveMsg,this)},e.prototype.sendData=function(t){if(null!=this.ws){var e=t[0];t[1],t[2];this.ws.sendData(e)}},e.prototype.showState=function(t){},e.prototype.onReciveMsg=function(t){var e=t.data,n=e.MsgType+"";switch(n){case NetCommands.MSG_TYPE_OF_HEART_BEAT:WS.heartBeatCount=0,WS.connectTime=ConfigData.RECONECTTIME;break;case NetCommands.MSG_TYPE_OF_PLAY_ERROR:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_PLAY_ERROR,e);break;case NetCommands.MSG_TYPE_OF_RECON_GAME:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_RECON_GAME,e);break;case NetCommands.MSG_TYPE_OF_GET_CARDS:break;case NetCommands.MSG_TYPE_OF_CALL_SCORE:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_CALL_LANDlORD,e);break;case NetCommands.MSG_TYPE_OF_ROLE_GRAB:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_ROLE_GRAB,e);break;case NetCommands.MSG_TYPE_OF_JIA_BEI:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_JIA_BEI,e);break;case NetCommands.MSG_TYPE_OF_JIA_BEI_RESULT:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_JIA_BEI_RESULT,e);break;case NetCommands.MSG_TYPE_OF_SEND_BOTTOM_CARDS:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_GRAB_SUCCESS,e);break;case NetCommands.MSG_TYPE_OF_SCORE_CHANGE:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_SCORE_CHANGE,e);break;case NetCommands.MSG_TYPE_OF_SEND_CARD:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_SET_CARD,e);break;case NetCommands.MSG_TYPE_OF_TIME_TICKER:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_PLAY_GAME,e);break;case NetCommands.MSG_TYPE_OF_PLAY_CARD_SUCCESS:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_ON_PLAY_CARD,e);break;case NetCommands.MSG_TYPE_OF_GAME_OVER:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_GAME_OVER,e);break;case NetCommands.NIUNIU_SEND_CARD:this.channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_SET_CARD,e);break;case NetCommands.NIUNIU_CALL_SCORE:this.channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_CALL_LANDlORD,e);break;case NetCommands.NIUNIU_ROLE_XIAZHU_BROAD:this.channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_XIAZHU,e);break;case NetCommands.NIUNIU_QIANG_ZHUANG_BROAD:this.channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_QIANG_ZHUANG_BROAD,e);break;case NetCommands.NIUNIU_ROLE_GRAB_ID:this.channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_GRAB_SUCCESS,e);break;case NetCommands.NIUNIU_ROLE_XIAZHU_RESULT:this.channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_SCORE_CHANGE,e);break;case NetCommands.NIUNIU_JIESUAN:this.channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_JIESUAN,e);break;case NetCommands.BAI_NIUNIU_ROLE_GRAB_ID:this.channel.postCommand(ConstData.BAI_NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_BAI_NIU_GRAB_SUCCESS,e);break;case NetCommands.BAI_NIUNIU_ROLE_XIAZHU_BROAD:this.channel.postCommand(ConstData.BAI_NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_BAI_NIU_BROAD_XIAZHU,e);break;case NetCommands.BAI_NIUNIU_ROLE_XIAZHU_RESULT:this.channel.postCommand(ConstData.BAI_NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_BAI_NIU_XIAZHU,e);break;case NetCommands.BAI_NIUNIU_JIESUAN:this.channel.postCommand(ConstData.BAI_NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_BAI_NIU_JIESUAN,e)}},e.prototype.onRecivePlayGame=function(t){var e=t.SubMsgType;if(void 0!=e&&8!=e)switch(e){case NetCommands.MSG_TYPE_OF_CHAT:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_CHAT,t);break;case NetCommands.MSG_TYPE_OF_CALL_SCORE:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_CALL_LANDlORD,t);break;case NetCommands.MSG_TYPE_OF_SEND_BOTTOM_CARDS:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_GRAB_SUCCESS,t);break;case NetCommands.MSG_TYPE_OF_PASS:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_ON_PASS_CARD,t);break;case NetCommands.MSG_TYPE_OF_PLAY_ERROR:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_CARD_ERROR,t);break;case NetCommands.MSG_TYPE_OF_INVAILD:this.channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_INVAILD)}},e.prototype.destroy=function(){this.ws&&this.ws.destroy(),this.dispatcher=null,this.callBackPool=null},e}(Controller);__reflect(NetController.prototype,"NetController");var NiuniuBattleController=function(t){function e(e){var n=t.call(this,e)||this;return n.addCommand(ConstData.BATTLE_NIU_MATCH_PLAYERS,n.matchPlayers,n),n.addCommand(ConstData.BATTLE_NIU_SET_CARD,n.setCard,n),n.addCommand(ConstData.BATTLE_NIU_GRAB_SUCCESS,n.grablandLordSuccess,n),n.addCommand(ConstData.BATTLE_NIU_CALL_LANDlORD,n.jiaoZhuang,n),n.addCommand(ConstData.BATTLE_NIU_XIAZHU,n.xiaZhu,n),n.addCommand(ConstData.BATTLE_NIU_JIESUAN,n.jiesuan,n),n.addCommand(ConstData.BATTLE_NIU_CLEAR,n.clear,n),n.addCommand(ConstData.BATTLE_NIU_RECON_GAME,n.reconName,n),n.addCommand(ConstData.BATTLE_NIU_SCORE_CHANGE,n.onScoreChange,n),n.addCommand(ConstData.BATTLE_NIU_QIANG_ZHUANG_BROAD,n.onScoreChange,n),n.addCommand(ConstData.BATTLE_NIU_CLOSE_MATCH_TIMER,n.closeMatchTimer,n),n.addCommand(ConstData.BATTLE_NIU_INVAILD,n.invaild,n),n.addCommand(ConstData.BATTLE_NIU_RETURN_GROUND,n.returnGround,n),n.addCommand(ConstData.BATTLE_NIU_ROOM_ROLE_CHANGE,n.roomRoleChange,n),n}return __extends(e,t),e.prototype.init=function(){},e.prototype.reconName=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);e.reconGame(t)},e.prototype.setCard=function(t){void 0===t&&(t=null);var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);e.onMatchPlayerBack(t),e.setCard(t)},e.prototype.matchPlayers=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);t.matchPlayers()},e.prototype.roomRoleChange=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);e.roomRoleChange(t)},e.prototype.grablandLordSuccess=function(t){void 0===t&&(t=null);var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);e.grabLandLordSuccess(t)},e.prototype.jiaoZhuang=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);e.jiaoZhuang(t)},e.prototype.xiaZhu=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);setTimeout(e.xiaZhu.bind(e,t),2800)},e.prototype.onScoreChange=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);e.onScoreChange(t)},e.prototype.closeMatchTimer=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);t.closeMatchTimer()},e.prototype.invaild=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);t.invaild()},e.prototype.returnGround=function(){var t=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);t.returnGround()},e.prototype.clear=function(t){var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);e.clear()},e.prototype.jiesuan=function(t){void 0===t&&(t=null);var e=this.channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_VIEW_BY_NAME,ConstData.NIUNIU_BATTLE_VIEW);setTimeout(e.jiesuan.bind(e,t),1e3)},e}(Controller);__reflect(NiuniuBattleController.prototype,"NiuniuBattleController");var SoundController=function(t){function e(e){var n=t.call(this,e)||this;return n._else_snd_channel=[],n._isBack=!1,n._noPlaySnd=!1,n._noPlayMusic=!1,n.addCommand(ConstData.SOUND_PLAY_MUSIC,n.playMusic,n),n.addCommand(ConstData.SOUND_PLAY_SOUND,n.playSound,n),n.addCommand(ConstData.SOUND_PLAY_EFFECT,n.playEffectSound,n),n.addCommand(ConstData.SOUND_PLAY_POKER,n.playPokerSound,n),n.addCommand(ConstData.SOUND_STOP_SOUND,n.stopSound,n),n.addCommand(ConstData.SOUND_STOP_ALL_SOUND,n.stopAllSound,n),n.addCommand(ConstData.SOUND_PLAY_ONCE,n.playOnce,n),n.addCommand(ConstData.SOUND_SET_IS_BACK,n.setIsBack,n),n.addCommand(ConstData.SOUND_IS_PLAY_SND,n.setIsPlaySnd,n),n.addCommand(ConstData.SOUND_IS_PLAY_MUSIC,n.setIsPlayMusic,n),n.addCommand(ConstData.SOUND_GET_PLAY_SND,n.getIsPlaySnd,n),n.addCommand(ConstData.SOUND_GET_PLAY_MUSIC,n.getIsPlayMusic,n),n}return __extends(e,t),e.prototype.init=function(){},e.prototype.setIsPlaySnd=function(t){this._noPlaySnd=t},e.prototype.getIsPlaySnd=function(){return this._noPlaySnd},e.prototype.setIsPlayMusic=function(t){this._noPlayMusic=t,this._noPlayMusic?this.stopSound(1):this.playMusic([this._lastName]),console.log(this._noPlayMusic)},e.prototype.getIsPlayMusic=function(){return this._noPlayMusic},e.prototype.setIsBack=function(t){this._isBack=t},e.prototype.playOnce=function(t){if(!this._isBack&&!this._noPlaySnd){var e=t[0],n=t[1]?t[1]:1,a=RES.getRes(e);a&&this._else_snd_channel.push(a.play(0,n))}},e.prototype.playMusic=function(t){var e=t[0];if(this._lastName=t[0],!this._isBack&&!this._noPlayMusic){var n=t[1]?t[1]:0,a=RES.getRes(e);this.stopSound(1),a&&(this._music_snd_channel=a.play(0,n))}},e.prototype.playSound=function(t){if(!this._isBack&&!this._noPlaySnd){var e=t[0],n=t[1]?t[1]:1,a=RES.getRes(e);this.stopSound(0),a&&(this._snd_channel=a.play(0,n))}},e.prototype.playPokerSound=function(t){if(!this._isBack&&!this._noPlaySnd){var e=t[0],n=t[1]?t[1]:1,a=RES.getRes(e);this.stopSound(3),a&&(this._poker_snd_channel=a.play(0,n))}},e.prototype.playEffectSound=function(t){if(!this._isBack&&!this._noPlaySnd){var e=t[0],n=t[1]?t[1]:1,a=RES.getRes(e);this.stopSound(2),a&&(this._effect_snd_channel=a.play(0,n))}},e.prototype.stopSound=function(t){if(void 0===t&&(t=0),0==t)this._snd_channel&&this._snd_channel.stop();else if(1==t)this._music_snd_channel&&this._music_snd_channel.stop();else if(2==t)this._effect_snd_channel&&this._effect_snd_channel.stop();else if(3==t)this._poker_snd_channel&&this._poker_snd_channel.stop();else if(4==t)for(var e=0;e<this._else_snd_channel.length;e++)this._else_snd_channel[e]&&this._else_snd_channel[e].stop()},e.prototype.stopAllSound=function(t){void 0===t&&(t=null),this._snd_channel&&this._snd_channel.stop(),this._music_snd_channel&&this._music_snd_channel.stop(),this._effect_snd_channel&&this._effect_snd_channel.stop(),this._poker_snd_channel&&this._poker_snd_channel.stop()},e}(Controller);__reflect(SoundController.prototype,"SoundController");var UIController=function(t){function e(e){var n=t.call(this,e)||this;return n._viewList=new Object,n._viewHash=new Object,n._isBin=!1,n.addCommand(ConstData.UI_GET_VIEW_BY_NAME,n.getViewByName,n),n.addCommand(ConstData.UI_SHOW_VIEW_BY_NAME,n.showViewByName,n),n.addCommand(ConstData.UI_REMOVE_VIEW_BY_NAME,n.removeViewByName,n),n.addCommand(ConstData.UI_REMOVE_ALL_VIEW,n.removeAllView,n),n.addCommand(ConstData.UI_DESTROY_VIEW_BY_NAME,n.destroyViewByName,n),n.addCommand(ConstData.UI_DESTROY_ALL_VIEW,n.destroyAllView,n),n.addCommand(ConstData.UI_ADD_WAIT,n.addWaitView,n),n.addCommand(ConstData.UI_REMOVE_WAIT,n.removeWaitView,n),n.addCommand(ConstData.UI_ADD_TIP,n.addTip,n),n.addCommand(ConstData.UI_REMOVE_TIP,n.removeTip,n),n.addCommand(ConstData.UI_SHOW_OVER,n.showOver,n),n.addCommand(ConstData.UI_GET_CURRENT_VIEW,n.getCurrentViewName,n),n}return __extends(e,t),e.prototype.init=function(){this._viewHash[ConstData.LOGIN_VIEW]=Login,this._viewHash[ConstData.HALL_VIEW]=Hall,this._viewHash[ConstData.GROUND_VIEW]=Ground,this._viewHash[ConstData.PREGAME_VIEW]=Pregame,this._viewHash[ConstData.BATTLE_VIEW]=Battle,this._viewHash[ConstData.WIN_VIEW]=Win,this._viewHash[ConstData.LOSE_VIEW]=Lose,this._viewHash[ConstData.WAIT_VIEW]=WaitView,this._viewHash[ConstData.TIP_VIEW]=TipView,this._viewHash[ConstData.RECHARGE_VIEW]=Recharge,this._viewHash[ConstData.CASH_VIEW]=Cash,this._viewHash[ConstData.MATCH_END_VIEW]=MatchEnd,this._viewHash[ConstData.GAME_RULE_VIEW]=GameRule,this._viewHash[ConstData.NIUNIU_LOADING_VIEW]=NiuniuLoadingView,this._viewHash[ConstData.NIUNIU_GROUND_VIEW]=NiuniuGround,this._viewHash[ConstData.NIUNIU_BATTLE_VIEW]=NiuniuBattle,this._viewHash[ConstData.BAIREN_NIUNIU_GROUND_VIEW]=BairenNiuniuGround,this._viewHash[ConstData.BAIREN_NIUNIU_BATTLE_VIEW]=BairenNiuniuBattle,this._root=Game.instance.root},e.prototype.getViewByName=function(t){return this._viewList[t]||(this._viewList[t]=new this._viewHash[t](this.channel)),this._viewList[t]},e.prototype.showViewByName=function(t){var e=t[0],n=this.getViewByName(e);if(void 0==t[1])n.x=(this._root.stageWidth-n.width)/2,n.y=(this._root.stageHeight-n.height)/2;else{var a=t[1],i=t[2];n.x=a,n.y=i}n instanceof Ground?this._currentViewName=ConstData.GROUND_VIEW:n instanceof Battle?this._currentViewName=ConstData.BATTLE_VIEW:n instanceof Win?this._currentViewName=ConstData.WIN_VIEW:n instanceof Lose&&(this._currentViewName=ConstData.LOSE_VIEW);var o=this.channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_GET_LAYER,t[3]);return o.addChild(n),n.init&&n.init(),n},e.prototype.getCurrentViewName=function(){return this._currentViewName},e.prototype.removeViewByName=function(t){var e=t[0],n=t[1],a=this.getViewByName(e);return a.parent&&(a.parent.removeChild(a),a.removeView&&a.removeView(),n&&a.destroy()),a},e.prototype.removeAllView=function(t){for(var e in this._viewList)this.removeViewByName([e,t])},e.prototype.destroyViewByName=function(t){var e=this.getViewByName(t);e&&(e.parent&&e.parent.removeChild(e),e.destroy&&e.destroy(),delete this._viewList[t])},e.prototype.destroyAllView=function(){for(var t in this._viewList)this.destroyViewByName(t)},e.prototype.addWaitView=function(t){if(!this._isBin){var e=this.showViewByName([ConstData.WAIT_VIEW,0,0,ConstData.UI_LAYER]);e.addWait(t)}},e.prototype.removeWaitView=function(t){if(!this._isBin){this._root&&(this._root.touchChildren=!0);var e=this.removeViewByName([ConstData.WAIT_VIEW]);e.removeWait()}},e.prototype.addTip=function(t){void 0===t&&(t=["",500,-1,-1]);var e=this.showViewByName([ConstData.TIP_VIEW,0,0,ConstData.TOP_LAYER]);e.addTip(t)},e.prototype.removeTip=function(){var t=this.getViewByName(ConstData.TIP_VIEW);t.removeTip()},e.prototype.showOver=function(t){var e;"win"==t.overType?e=this.showViewByName([ConstData.WIN_VIEW,0,0,ConstData.TOP_LAYER]):"lose"==t.overType&&(e=this.showViewByName([ConstData.LOSE_VIEW,0,0,ConstData.TOP_LAYER])),e&&e.show(t)},e}(Controller);__reflect(UIController.prototype,"UIController");var AnimateManager=function(){function t(){this.mcHash=new Object,this.funcHash=new Object}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.hasAnimate=function(t){return this.mcHash.hasOwnProperty(t)},t.prototype.createDragonBones=function(t,e,n,a,i){void 0===i&&(i=function(){});var o=RES.getRes(e),s=RES.getRes(n),r=RES.getRes(a),_=new dragonBones.EgretFactory,h=dragonBones.DataParser.parseDragonBonesData(o);_.addDragonBonesData(h),_.addTextureAtlasData(_.parseTextureAtlasData(s,r));
var l;l=_.buildArmature(h.armatureNames[0]);var c=l.display;return dragonBones.WorldClock.clock.add(l),t.addChild(c),l.animation.gotoAndPlay(h.stage.defaultAnimation.name),egret.startTick(this.onTicker,this),l.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,i,this),l},t.prototype.onTicker=function(t){this._time||(this._time=t);var e=t,n=e-this._time;return this._time=e,dragonBones.WorldClock.clock.advanceTime(n/1e3),!1},t.prototype.startPlay=function(t){console.log("armature 开始播放动画！")},t.prototype.loop_com=function(t){console.log("armature 动画播放完一轮完成！")},t.prototype.frame_event=function(t){console.log("armature 播放到了一个关键帧！ 帧标签为：",t.frameLabel)},t.prototype.createAnimate=function(t,e,n,a,i,o,s){void 0===a&&(a=0),void 0===i&&(i=24),void 0===o&&(o=null),void 0===s&&(s=null);var r=new egret.MovieClipDataFactory(RES.getRes(t+"_json"),RES.getRes(t+"_png")),_=new egret.MovieClip(r.generateMovieClipData(e));return 0==_.totalFrames?new egret.MovieClip:(_.frameRate=i,_.name=e,o&&(this.funcHash[e]=[o,s],_.addEventListener(egret.MovieClipEvent.COMPLETE,this.finishPlay,this)),_.gotoAndStop(1),n.addChild(_),_.play(a),_)},t.prototype.finishPlay=function(t){var e=t.target;this.funcHash[e.name]&&this.funcHash[e.name][0].call(this.funcHash[e.name][1],e),delete this.funcHash[e.name],e.removeEventListener(egret.MovieClipEvent.COMPLETE,this.finishPlay,this)},t.prototype.removeAnimate=function(){for(var t in this.mcHash){var e=this.mcHash[t];e&&e.gotoAndStop(1),e&&e.parent&&e.parent.removeChild(e),delete this.mcHash[t]}},t.prototype.destroy=function(){var e;for(e in this.mcHash){var n=this.mcHash[e];n&&(n.hasEventListener(egret.MovieClipEvent.COMPLETE)&&n.removeEventListener(egret.MovieClipEvent.COMPLETE,this.finishPlay,this),n.stop()),delete this.mcHash[e]}this.mcHash=null;for(e in this.funcHash)delete this.funcHash[e];this.funcHash=null,t._instance=null},t}();__reflect(AnimateManager.prototype,"AnimateManager");var CardUtils=function(){function t(){this.effect_frame_rate=8,this.posObj={},this.animateBmp=new egret.Bitmap,this._cardPool=[],this._channel=CommandChannel.instance}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.getPoint=function(t){var e=0;if(53==t)e=16;else if(54==t)e=17;else{var n=t%13;1==n?e=14:2==n?e=15:3==n?e=3:4==n?e=4:5==n?e=5:6==n?e=6:7==n?e=7:8==n?e=8:9==n?e=9:10==n?e=10:11==n?e=11:12==n?e=12:0==n&&(e=13)}return e},t.prototype.setPosByDir=function(t){this.posObj=t},t.prototype.removeAnimate=function(){this.animateBmp&&(egret.Tween.removeTweens(this.animateBmp),this.animateBmp.parent&&this.animateBmp.parent.removeChild(this.animateBmp))},t.prototype.addAnimate=function(t,e){var n=this,a=this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_GET_LAYER,ConstData.UI_LAYER);this.animateBmp.scaleX="left"==t||"my"==t?1:-1,this.animateBmp.alpha=1;var i,o;switch(e){case 7:this.removeAnimate(),i=AnimateManager.instance.createAnimate("ddz_ani","shunzi",a,0,this.effect_frame_rate,function(t){t.parent&&t.parent.removeChild(t)}),i.x=this.posObj[t].x,i.y=this.posObj[t].y;break;case 8:this.removeAnimate(),i=AnimateManager.instance.createAnimate("ddz_ani","liandui",a,0,this.effect_frame_rate,function(t){t.parent&&t.parent.removeChild(t)}),i.x=this.posObj[t].x,i.y=this.posObj[t].y;break;case 9:case 10:case 11:this.removeAnimate(),i=AnimateManager.instance.createAnimate("ddz_ani","feiji",a,0,this.effect_frame_rate,function(t){t.parent&&t.parent.removeChild(t)}),i.x=this.posObj[t].x,i.y=this.posObj[t].y,o=AnimateManager.instance.createDragonBones(a,"aircraft-2_ske_json","aircraft-2_tex_json","aircraft-2_tex_png",function(){n.finishDragonBones(o)}),o.display.x=ConfigData.stageWidth/2,o.display.y=ConfigData.stageHeight/2,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_EFFECT,["feiji_effect_snd_mp3"]);break;case 12:this.removeAnimate(),i=AnimateManager.instance.createAnimate("ddz_ani","zhadan",a,0,this.effect_frame_rate,function(t){t.parent&&t.parent.removeChild(t)}),i.x=this.posObj[t].x,i.y=this.posObj[t].y,o=AnimateManager.instance.createDragonBones(a,"Boom-1_ske_json","Boom-1_tex_json","Boom-1_tex_png",function(){n.finishDragonBones(o)}),o.display.x=ConfigData.stageWidth/2,o.display.y=ConfigData.stageHeight/2,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_EFFECT,["bomb_effect_snd_mp3"]);break;case 13:this.removeAnimate(),i=AnimateManager.instance.createAnimate("ddz_ani","huojian",a,0,this.effect_frame_rate,function(t){t.parent&&t.parent.removeChild(t)}),i.x=this.posObj[t].x,i.y=this.posObj[t].y,o=AnimateManager.instance.createDragonBones(a,"Boom-2_ske_json","Boom-2_tex_json","Boom-2_tex_png",function(){n.finishDragonBones(o)}),o.display.x=ConfigData.stageWidth/2,o.display.y=ConfigData.stageHeight/2,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_EFFECT,["huojian_effect_snd_mp3"])}},t.prototype.finishDragonBones=function(t){t.dispose(),t.display&&t.display.parent&&t.display.parent.removeChild(t.display)},t.prototype.playCardSnd=function(t,e){if(e){var n=e.type,a=this.getPoint(e.cards[0]);switch(this.addAnimate(t,n),n){case 1:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["card"+a+"_snd_mp3"]);break;case 2:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["dui"+a+"_snd_mp3"]);break;case 3:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["san"+a+"_snd_mp3"]);break;case 4:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["sandaiyi_snd_mp3"]);break;case 5:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["sandaiyidui_snd_mp3"]);break;case 6:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["sidaier_snd_mp3"]);break;case 7:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["shunzi_snd_mp3"]);break;case 8:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["liandui_snd_mp3"]);break;case 9:case 10:case 11:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["feiji_snd_mp3"]);break;case 12:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["bomb_snd_mp3"]);break;case 13:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["huojian_snd_mp3"]);break;case 14:this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["sidailiangdui_snd_mp3"])}}},t.prototype.canPlay=function(t,e){if(!t)return CommandChannel.instance.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["上家还没出牌",500,-1,536]),!1;var n=t.header,a=t.type,i=this.calcCardType(e),o=this.calcHeadPoker(i,e);if(-1==a&&0!==i)return!0;if(13==i)return!0;if(13==a)return!1;if(12==i){if(12!=a)return!0;if(o>n)return!0}return a==i&&o>n&&t.cards.length==e.length?!0:!1},t.prototype.calcCardType=function(t,e){void 0===e&&(e=null);var n=t?this.transCardsToPoint(t):e,a=n.length;return 1==a?1:2==a?n[0]==n[1]?2:n[0]+n[1]==33?13:0:3==a&&n[0]==n[1]&&n[1]==n[2]?3:4==a?n[0]==n[1]&&n[1]==n[2]&&n[2]==n[3]?12:3==this.calcSameNum(n)?4:0:a>=5&&this.isNumContinuous(n)?7:5==a&&3==this.calcSameNum(n)&&2==this.calcDiffNum(n)?5:a>=6?3==this.calcSameNum(n)&&a%3==0&&this.calcDiffNum(n)==a/3&&this.calcDiffContin(n)?9:2==this.calcSameNum(n)&&a%2==0&&this.calcDiffNum(n)==a/2&&this.calcDiffContin(n)?8:a%4==0&&this.sameNumAndContin(n,3,a/4)?10:a%5==0&&3==this.calcSameNum(n)&&this.sameNumAndContin(n,3,a/5)&&this.calcDiffNum(n)==a/5*2?11:6==a&&4==this.calcSameNum(n)?6:8==a&&4==this.calcSameNum(n)&&3==this.getSameNum(n,2)?14:0:0},t.prototype.calcHeadPoker=function(t,e,n){void 0===n&&(n=null);var a=e?this.transCardsToPoint(e):n;switch(a.sort(function(t,e){return e>t?1:t>e?-1:void 0}),t){case 1:case 2:case 3:case 7:case 8:case 9:case 12:return a[0];case 4:case 5:case 6:case 10:return a[2];case 11:return this.calcFlightDouble(a)}return 0},t.prototype.calcSameNum=function(t){for(var e=0,n=0;n<t.length;n++){for(var a=1,i=0;i<t.length;i++)i!=n&&t[n]==t[i]&&a++;a>e&&(e=a)}return e},t.prototype.getCardExpect=function(t,e,n,a){void 0===n&&(n=1),void 0===a&&(a=!1);for(var i=0,o=t.length,s=this.transCardsToPoint(t),r=[];;){for(i=0;o>i;i++){for(var _=t[i].point,h=!1,l=0;l<e.length;l++){if(e[l]instanceof Card&&e[l]==t[i]){h=!0;break}if(_==e[l]){h=!0;break}}a?this.getSameNumByPoint(s,n,_)&&!h&&r.push(t[i]):this.getSameNumByPoint(s,n+1,_)||h||r.push(t[i])}if(n++,n>3)break}return r.length>0?(r.sort(function(t,e){return t.point-e.point}),r[0]):null},t.prototype.getCardArrByPoint=function(t,e,n){for(var a=[],i=t.length,o=0;i>o;o++)t[o].point==e&&a.length!=n&&a.push(t[o]);return a},t.prototype.getSameNumHeaderBigger=function(t,e,n){void 0===n&&(n=0);for(var a,i=[];;){for(var o=0;o<t.length;o++)if(a=t[o],!(i.indexOf(a)>=0||e>=a)){for(var s=1,r=0;r<t.length;r++)r!=o&&a==t[r]&&s++;s==n&&i.push(t[o])}if(i.length>0)break;if(n++,n>3)break}return i.length>0&&i.sort(function(t,e){return e-t}),i},t.prototype.getBiggerThanCard=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null);var a,i,o=t.type,s=t.header,r=t.cards.length,_=[],h=e?this.transCardsToPoint(e):n,l=[],c=0,d=0;e.length;if((1==o||2==o||3==o||12==o)&&(d=4>o?o:4,l=this.getSameNumHeaderBigger(h,s,d),l.length>0)){if(l.sort(function(t,e){return t-e}),a=l[0],_=_.concat(this.getCardArrByPoint(e,a,d)),_.length==r)return _;_.splice(0,_.length)}if((4==o||5==o||6==o||14==o)&&(d=6==o||14==o?4:3,l=this.getSameNumHeaderBigger(h,s,d),l.length>0))if(l.sort(function(t,e){return t-e}),a=l[0],_=_.concat(this.getCardArrByPoint(e,a,d)),4==o){if(i=this.getCardExpect(e,[a],1),i&&_.push(i),_.length==r)return _;_.splice(0,_.length)}else if(5==o){if(i=this.getCardExpect(e,[a],2),i&&(_=_.concat(this.getCardArrByPoint(e,i.point,2))),_.length==r)return _;_.splice(0,_.length)}else if(6==o){if(i=this.getCardExpect(e,[a],2),i&&_.push(i),i=this.getCardExpect(e,[a,i],2),i&&_.push(i),_.length==r)return _;_.splice(0,_.length)}else if(14==o){if(i=this.getCardExpect(e,[a],2,!0),i&&(_=_.concat(this.getCardArrByPoint(e,i.point,2))),i=this.getCardExpect(e,[a,i.point],2,!0),i&&(_=_.concat(this.getCardArrByPoint(e,i.point,2))),_.length==r)return _;_.splice(0,_.length)}if((7==o||8==o||9==o)&&(d=o-6,l=this.getShunziBiggerThan(h,r/d,s,d,!0),l.length>0)){for(c=0;c<l.length;c++)_=_.concat(this.getCardArrByPoint(e,l[c],d));if(_.length==r)return _;_.splice(0,_.length)}if(10==o||11==o){d=3;var u=10==o?r/4:r/5;if(l=this.getShunziBiggerThan(h,u,s,d,!0),l.length>0){for(c=0;c<l.length;c++)_=_.concat(this.getCardArrByPoint(e,l[c],d));if(11==o){if(this.getSameNum(h,2)>2*u)for(c=0;u>c;c++)i=this.getCardExpect(e,l,2,!0),i&&(_=_.concat(this.getCardArrByPoint(e,i.point,2)),l.push(i.point));if(_.length==r)return _;_.splice(0,_.length)}else{for(c=0;u>c;c++)i=this.getCardExpect(e,l,2),i&&(_=_.concat(this.getCardArrByPoint(e,i.point,1)),l.push(i));if(_.length==r)return _;_.splice(0,_.length)}}}if(12!=o){if(l=this.getSameNumHeaderByType(h,4,!0),l.length>0)return l.sort(function(t,e){return t-e}),a=l[0],_=_.concat(this.getCardArrByPoint(e,a,4));if(this.getWangzha(h))return _=_.concat(this.getCardArrByPoint(e,16,1)),_=_.concat(this.getCardArrByPoint(e,17,1))}return _},t.prototype.biggerThan=function(t,e,n,a,i){if(void 0===a&&(a=null),void 0===i&&(i=null),-1==t)return!0;var o=a?this.transCardsToPoint(a):i;if(13==t)return!1;if(this.getWangzha(o))return!0;if(12!=t&&this.getSameNumHeaderByType(o,4)>-1)return!0;if(o.length<n)return!1;var s;if(1==t||2==t||3==t||12==t){if(s=4>t?t:4,this.getSameNumHeaderByType(o,s)>e)return!0}else if(4==t||5==t||6==t||14==t){if(s=6==t||14==t?4:3,this.getSameNumHeaderByType(o,s)<e)return!1;if(5!=t&&14!=t)return!0;if(5==t&&this.getSameNum(o,2)>1)return!0;if(14==t&&this.getSameNum(o,2)>2)return!0}else if(7==t||8==t||9==t){if(s=t-6,this.getShunziBiggerThan(o,n/s,e,s))return!0}else if(10==t||11==t){s=3;var r=10==t?n/4:n/5;if(this.getShunziBiggerThan(o,r,e,s)){if(11!=t)return!0;if(this.getSameNum(o,2)>3)return!0}}return!1},t.prototype.getSameNum=function(t,e){for(var n=0,a=[],i=0;i<t.length;i++)if(-1==a.indexOf(t[i])){for(var o=1,s=0;s<t.length;s++)s!=i&&t[i]==t[s]&&o++;o>=e&&(a.push(t[i]),n++)}return n},t.prototype.getWangzha=function(t){return t.indexOf(16)>=0&&t.indexOf(17)>=0},t.prototype.getSameNumHeaderByType=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!1);for(var a=[],i=0;i<t.length;i++)if(!(a.indexOf(t[i])>=0)){for(var o=1,s=0;s<t.length;s++)s!=i&&t[i]==t[s]&&o++;o>=e&&a.push(t[i])}return a.length>0&&a.sort(function(t,e){return e-t}),n?a:a.length>0?a[0]:-1},t.prototype.getShunziBiggerThan=function(t,e,n,a,i){if(void 0===i&&(i=!1),14==n)return!1;for(var o=[],s=n+1;14>=s;s++)if(o.splice(0,o.length),t.indexOf(s)>=0){for(var r=0,_=s;_>s-e&&(!(t.indexOf(_)<0)&&this.getSameNumByPoint(t,a,_));_--)o.push(_),r++;if(r==e)return i?o:!0}return i?o:!0},t.prototype.getSameNumByPoint=function(t,e,n){void 0===t&&(t=null);for(var a=t.length,i=0,o=0;a>o;o++)t[o]==n&&i++;return i>=e},t.prototype.calcDiffNum=function(t){for(var e=[],n=0;n<t.length;n++)-1==e.indexOf(t[n])&&e.push(t[n]);return e.length},t.prototype.calcDiffContin=function(t){for(var e=[],n=0;n<t.length;n++)-1==e.indexOf(t[n])&&e.push(t[n]);return this.isNumContinuous(e)},t.prototype.isNumContinuous=function(t){t.sort(function(t,e){return t-e});for(var e=0;e<t.length;e++){if(15==t[e])return!1;if(e==t.length-1)return!0;if(t[e]!=t[e+1]-1)return!1}return!0},t.prototype.sameNumAndContin=function(t,e,n){for(var a=0,i=[],o=0;o<t.length;o++)if(-1==i.indexOf(t[o])){for(var s=1,r=0;r<t.length;r++)r!=o&&t[o]==t[r]&&s++;s==e&&(i.push(t[o]),a++)}return a==n&&this.calcDiffContin(i)},t.prototype.calcFlightDouble=function(t){for(var e=[],n=0;n<t.length;n++){for(var a=0,i=0;i<t.length;i++)t[n]==t[i]&&a++;3==a&&-1==e.indexOf(t[n])&&e.push(t[n])}for(var o=0,i=0;i<e.length;i++)e[i]>o&&(o=e[i]);return o},t.prototype.transCardsToIndex=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].index);return e},t.prototype.transCardsToCardList=function(t){for(var e=[],n=0;n<t.length;n++){var a=t[n],i=new com.protobuff.data.CardModule;i.color=this.getColorByIndex(a.index),i.value=this.getPoint(a.index),e.push(i)}return e},t.prototype.transCardsToPoint=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].point);return e},t.prototype.getIndexArr=function(t){for(var e=[],n=t.length,a=0;n>a;a++)e.push(this.getCardId(t[a].color,t[a].value));return e},t.prototype.getColorByIndex=function(t){return t>=1&&13>=t?1:t>=14&&26>=t?0:t>=27&&39>=t||54==t?2:t>=40&&53>=t?3:void 0},t.prototype.getCardId=function(t,e){return 16==e?53:17==e?54:0!=t&&t?1==t?14==e?1:15==e?2:e:2==t?14==e?27:15==e?28:e+26:3==t?14==e?40:15==e?41:e+39:void 0:14==e?14:15==e?15:e+13},t.prototype.getCurCardsByIds=function(t){var e=[],n=new CurCards;if(t){for(var a=t.length,i=0;a>i;i++){var o=parseInt(t[i]);n.cards.push(o),e.push(this.getPoint(o))}n.type=this.calcCardType(null,e),n.header=this.calcHeadPoker(n.type,null,e)}return n},t.prototype.getCurCards=function(t){var e=[],n=t.length,a=new CurCards;a.cards=[];for(var i=0;n>i;i++){var o=t[i],s=this.getCardId(o.color,o.value);a.cards.push(s),e.push(this.getPoint(s))}return a.type=this.calcCardType(null,e),a.header=this.calcHeadPoker(a.type,null,e),a},t.prototype.getCardFromPool=function(t,e,n){for(var a,i=0;i<this._cardPool.length;i++)this._cardPool[i].index==t&&(a=this._cardPool[i],this._cardPool.splice(i,1));return!a&&(a=new Card(t)),a.setWidth(e),a.setHeight(n),a},t.prototype.addCardToPool=function(t){for(var e=0;e<this._cardPool.length;e++)if(this._cardPool[e].index==t.index)return;t.isSelect=!1,t.currentState=!1,t.onTouch=!1,t.touchEnabled=!0,this._cardPool.push(t)},t.prototype.destroy=function(){t._instance=null,this._channel=null;for(var e=this._cardPool.length,n=0;e>n;n++)this._cardPool[n].destroy();this._cardPool.splice(0,e),this._cardPool=null},t}();__reflect(CardUtils.prototype,"CardUtils");var CARD_TYPE=function(){function t(){}return t.PASS_CARDS=-2,t.NO_CARDS=-1,t.ERROR_CARDS=0,t.SINGLE_CARD=1,t.DOUBLE_CARD=2,t.THREE_CARD=3,t.THREE_ONE_CARD=4,t.THREE_TWO_CARD=5,t.BOMB_TWO_CARD=6,t.BOMB_FOUR_CARD=7,t.CONNECT_CARD=8,t.COMPANY_CARD=9,t.AIRCRAFT_CARD=10,t.AIRCRAFT_WING=11,t.BOMB_CARD=12,t.KINGBOMB_CARD=13,t.BOMB_TWO_DOUBLE__CARD=14,t}();__reflect(CARD_TYPE.prototype,"CARD_TYPE");var CommandChannel=function(){function t(){this._controllerList=new Object,this._dataProxyList=new Object,this.registerController(ConstData.GAME_CONTROLLER,new GameController(this)),this.registerController(ConstData.UI_CONTROLLER,new UIController(this)),this.registerController(ConstData.NET_CONTROLLER,new NetController(this)),this.registerController(ConstData.BATTLE_CONTROLLER,new BattleController(this)),this.registerController(ConstData.NIUNIU_BATTLE_CONTROLLER,new NiuniuBattleController(this)),this.registerController(ConstData.BAI_NIUNIU_BATTLE_CONTROLLER,new BairenNiuniuBattleController(this)),this.registerController(ConstData.SOUND_CONTROLLER,new SoundController(this)),this.registerDataProxy(ConstData.PLAYER_PROXY,new PlayerProxy(this)),this.init()}return t.prototype.init=function(){for(var t in this._controllerList)this._controllerList[t].init();for(var e in this._dataProxyList)this._dataProxyList[e].init()},Object.defineProperty(t,"instance",{get:function(){return null!=t._instance?t._instance:(t._instance=new t,t._instance)},enumerable:!0,configurable:!0}),t.prototype.registerController=function(t,e){this._controllerList.hasOwnProperty(t)||(this._controllerList[t]=e)},t.prototype.getController=function(t){return this._controllerList[t]?this._controllerList[t]:null},t.prototype.postCommand=function(t,e,n){void 0===n&&(n=null);var a=this.getController(t);return null!=a?a.executeCommand(e,n):null},t.prototype.registerDataProxy=function(t,e){this._dataProxyList.hasOwnProperty(t)||(this._dataProxyList[t]=e)},t.prototype.addFuncToDataProxy=function(t,e,n,a){var i=this.getDataProxy(t);i&&i.addDataFunc(e,n,a)},t.prototype.getDataProxy=function(t){return this._dataProxyList[t]?this._dataProxyList[t]:null},t.prototype.broadCastData=function(t,e,n){void 0===n&&(n=null);var a=this.getDataProxy(t);return null!=a?a.executeCommand(e,n):null},t}();__reflect(CommandChannel.prototype,"CommandChannel");var DisUtil=function(){function t(){}return t.size=function(t,e,n){t.width=e,t.height=n},t.ancho=function(t,e,n){t.anchorOffsetX=e,t.anchorOffsetY=n},t.location=function(t,e,n){t.x=e,t.y=n},t.getCloneBase=function(e){var n=new egret.DisplayObject;return t.location(n,0,0),t.size(n,e.width,e.height),n},t.getRelaRect=function(e,n){var a=t.getCloneBase(e);return a=t.getInRectRelaRect(a,e,n)},t.getInRectRelaRect=function(t,e,n){for(var a,i,o,s;e!=n;)egret.is(e,"egret.Stage")?(a=0,i=0,o=1,s=1):(a=e.x,i=e.y,o=e.scaleX,s=e.scaleY),t.x=a+(t.x-e.anchorOffsetX)*o,t.y=i+(t.y-e.anchorOffsetY)*s,t.width*=o,t.height*=s,e=e.parent;return t},t.get=function(e,n){var a=t.getRelaRect(e,n);return new situate(a,e,n)},t.setScal=function(t,e){t.scaleX=t.scaleY=e},t.scale=function(t,e){t.scaleX*=e,t.scaleY*=e},t.scalLen=function(t,e){t.width*=e,t.height*=e},t.disShow=function(t,e){e=e?e:1,console.log("x:"+t.x.toFixed(e)+",y:"+t.y.toFixed(e)+",anchorOffsetX:"+t.anchorOffsetX.toFixed(e)+",anchorOffsetY:"+t.anchorOffsetY.toFixed(e)+",scaleX:"+t.scaleX.toFixed(e)+",scaleY:"+t.scaleY.toFixed(e)+",width:"+t.width.toFixed(e)+",height:"+t.height.toFixed(e)+",alpha:"+t.alpha)},t}();__reflect(DisUtil.prototype,"DisUtil");var situate=function(){function t(t,e,n){this.relRect=t,this.disObj=e,this.ancient=n,n?(this.conWidth=n.width,this.conHeight=n.height):(this.conWidth=window.innerWidth,this.conHeight=window.innerHeight),this.anRateX=e.anchorOffsetX/e.width,this.anRateY=e.anchorOffsetY/e.height}return t.prototype.scale=function(t){var e=this,n=this.anRateX*(t-1)*e.relRect.width,a=this.anRateY*(t-1)*e.relRect.height;DisUtil.scale(e.disObj,t),DisUtil.scalLen(e.relRect,t),e.relRect.x-=n,e.relRect.y-=a},t.prototype.moveX=function(t,e){var n=this;n.relRect.x+=t,n.disObj.x+=t*=e},t.prototype.moveY=function(t,e){var n=this;n.relRect.y+=t,n.disObj.y+=t*=e},t.prototype.fitW=function(){var t=this;if(0==t.relRect.width)return egret.error("宽度为0的显示对象无法应用“适应宽度”的缩放模式"),this;var e=t.conWidth/t.relRect.width;return t.scale(e),t.cenHor(),t},t.prototype.fitH=function(){var t=this;if(0==t.relRect.height)return egret.error("高度为0的显示对象无法应用“适应高度”的缩放模式"),this;var e=t.conHeight/t.relRect.height;return t.scale(e),t.cenVer(),t},t.prototype.beCon=function(){var t=this,e=t.conWidth/t.conHeight,n=t.relRect.width/t.relRect.height,a=n>=e?t.conWidth/t.relRect.width:t.conHeight/t.relRect.height;return t.scale(a),t.center(),this},t.prototype.cover=function(){var t=this,e=t.conWidth/t.conHeight,n=t.relRect.width/t.relRect.height,a=n>=e?t.conHeight/t.relRect.height:t.conWidth/t.relRect.width;return t.scale(a),t.center(),this},t.prototype.center=function(){return this.cenVer(),this.cenHor(),this},t.prototype.cenVer=function(){var t=this,e=t.conHeight/2-t.relRect.y-t.relRect.height/2,n=t.disObj.height*t.disObj.scaleY/t.relRect.height;return t.moveY(e,n),t},t.prototype.cenHor=function(){var t=this,e=t.conWidth/2-t.relRect.x-t.relRect.width/2,n=t.disObj.width*t.disObj.scaleX/t.relRect.width;return t.moveX(e,n),t},t.prototype.left=function(t){t=null==t?0:t;var e=this,n=e.disObj.width*e.disObj.scaleX/e.relRect.width,a=t-e.relRect.x;return e.moveX(a,n),this},t.prototype.right=function(t){var e=this;t=null==t?0:t;var n=e.disObj.width*e.disObj.scaleX/e.relRect.width,a=e.conWidth-e.relRect.x-e.relRect.width-t;return e.moveX(a,n),this},t.prototype.top=function(t){t=null==t?0:t;var e=this,n=e.disObj.height*e.disObj.scaleY/e.relRect.height,a=t-e.relRect.y;return e.moveY(a,n),this},t.prototype.bottom=function(t){t=null==t?0:t;var e=this;t=null==t?0:t;var n=e.disObj.height*e.disObj.scaleY/e.relRect.height,a=e.conHeight-e.relRect.y-e.relRect.height-t;return e.moveY(a,n),this},t.prototype.show=function(t){t=t?t:1;var e=this.relRect;return console.log("x:"+e.x.toFixed(t)+",y:"+e.y.toFixed(t)+",width:"+e.width.toFixed(t)+",height:"+e.height.toFixed(t)),this},t}();__reflect(situate.prototype,"situate");var EffectManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.fromToEffect=function(t,e,n,a,i,o,s,r,_){void 0===r&&(r=null),void 0===_&&(_=1);for(var h=function(a){var h=RES.getRes(o);if(!h){try{throw new Error("粒子资源不存在:"+o)}catch(l){alert("粒子资源不存在:"+o)}return{value:void 0}}var c=new eui.Image(h);c.x=e.x-c.width/2,c.y=e.y-c.height/2,c.scaleX=c.scaleY=_,t.addChild(c),egret.Tween.get(c).wait(a*s).to({x:n.x,y:n.y},i).call(function(){c.parent.removeChild(c),r&&r()})},l=0;a>l;l++){var c=h(l);if("object"==typeof c)return c.value}},t}();__reflect(EffectManager.prototype,"EffectManager");var Game=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.root=this.stage,this._channel=CommandChannel.instance,this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_INIT_GAME_LAYER),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.LOGIN_VIEW,0,0,ConstData.UI_LAYER])},e.prototype.update=function(){},Object.defineProperty(e,"instance",{get:function(){return null!=e._instance?e._instance:(e._instance=new e,e._instance)},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(Game.prototype,"Game");var GameLayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.gameScene=new eui.UILayer,this.addChild(this.gameScene),this.UILayer=new egret.Sprite,this.gameScene.addChild(this.UILayer),this.animateLayer=new egret.Sprite,this.gameScene.addChild(this.animateLayer),this.effectLayer=new egret.Sprite,this.gameScene.addChild(this.effectLayer),this.topLayer=new egret.Sprite,this.gameScene.addChild(this.topLayer);var t=window.devicePixelRatio||1;document.documentElement.clientWidth*t,document.documentElement.clientHeight*t},e.prototype.clearAllLayer=function(){this.UILayer.removeChildren(),this.animateLayer.removeChildren(),this.effectLayer.removeChildren(),this.topLayer.removeChildren()},e}(egret.DisplayObjectContainer);__reflect(GameLayer.prototype,"GameLayer");var GameUtils=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return null!=t._instance?t._instance:(t._instance=new t,t._instance)},enumerable:!0,configurable:!0}),t.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},t.prototype.setAnimation=function(t,e,n,a,i,o){void 0===a&&(a=null),void 0===i&&(i=null),void 0===o&&(o=null),egret.Tween.get(t).to(e,n).call(a,i,o)},t}();__reflect(GameUtils.prototype,"GameUtils");var SendCardAnimal=function(){function t(){this._cardLayer=null,this._overfun=null,this._overThis=null,this._params=null,this._timer1=null,this._mCard1=null,this._mCard2=null,this._mCard3=null,this._dx=0,this._sendSpeed=200,this._channel=CommandChannel.instance,this._dx=(ConfigData.stageWidth-90)/2,this._dy=144,this._timer1=new egret.Timer(200,17)}return Object.defineProperty(t,"instance",{get:function(){return!t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.startAnimal=function(t,e,n,a,i){void 0===i&&(i=null),this._mCard1=t[0],this._mCard2=t[1],this._mCard3=t[2],this._overfun=n,this._overThis=a,this._params=i,this._cardLayer=e,this.sendCardAni()},t.prototype.sendCardAni=function(){var t=this,e=CardUtils.instance.getCardFromPool(0,90,124),n=this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_GET_LAYER,ConstData.UI_LAYER);n.addChild(e),e.name="bottomCard",e.x=this._dx,e.y=this._dy,this._cardLayer.parent.addChild(this._mCard1),this._mCard1.x=this._dx,this._mCard1.y=this._dy,this._cardLayer.parent.addChild(this._mCard2),this._mCard2.x=this._dx,this._mCard2.y=this._dy,this._cardLayer.parent.addChild(this._mCard3),this._mCard3.x=this._dx,this._mCard3.y=this._dy,egret.Tween.get(this._mCard1,{loop:!0}).wait(0).call(function(){t._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["play_card_snd_mp3"])}).to({x:ConfigData.CARDWIDTH},this._sendSpeed).to({x:this._dx},0).wait(100),egret.Tween.get(this._mCard2,{loop:!0}).wait(50).call(function(){t._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["play_card_snd_mp3"])}).to({x:ConfigData.stageWidth-ConfigData.CARDWIDTH},this._sendSpeed).to({x:this._dx},0).wait(50),egret.Tween.get(this._mCard3,{loop:!0}).wait(100).call(function(){t._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["play_card_snd_mp3"])}).to({y:this._dy+ConfigData.VERCARGAP+ConfigData.CARDHEIGHT},this._sendSpeed).to({y:this._dy},0),this._timer1.start(),this._timer1.hasEventListener(egret.TimerEvent.TIMER)||this._timer1.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)},t.prototype.onTimer=function(t){var e=this._timer1.currentCount;if(e==this._timer1.repeatCount)egret.Tween.removeTweens(this._mCard1),egret.Tween.removeTweens(this._mCard2),egret.Tween.removeTweens(this._mCard3),this.setCard(Player.instance.cardList),this._timer1.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer1.reset(),this.showOwnerAni();else{var n=Player.instance.cardList.slice(0,e);this.setCard(n)}},t.prototype.showOwnerAni=function(){var t=this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_GET_LAYER,ConstData.UI_LAYER),e=t.getChildByName("bottomCard");e&&e.parent.removeChild(e),this._mCard1.parent&&this._mCard1.parent.removeChild(this._mCard1),this._mCard2.parent&&this._mCard2.parent.removeChild(this._mCard2),this._mCard3.parent&&this._mCard3.parent.removeChild(this._mCard3),this._overfun&&this._overfun.call(this._overThis,this._params)},t.prototype.setCard=function(t){this._cardLayer.removeChildren();var e=t.length,n=ConfigData.stageWidth-ConfigData.LEFTGAP-ConfigData.CARDWIDTH,a=n/(e-1);a>ConfigData.HORCARGAP&&(a=ConfigData.HORCARGAP);for(var i=ConfigData.LEFTGAP+(n-a*(e-1)-ConfigData.CARDWIDTH)/2,o=0;e>o;o++){var s=t[o];s.y=528,s.x=i+o*a,this._cardLayer.addChild(s)}},t.prototype.Release=function(t){if(0==t){var e=this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_GET_LAYER,ConstData.ANIMATE_LAYER);return void e.removeChildren()}var n=20,a=100;1==t?(n=40,a=-520):2==t?(n=500,a=-520):3==t&&(n=250,a=0),this._mCard3&&egret.Tween.get(this._mCard3).to({x:n,y:a},500).call(function(){this._gameScene.removeChildren()},this),this._mCard2&&egret.Tween.get(this._mCard2).to({x:n,y:a},500).call(function(){this._gameScene.removeChildren()},this),this._mCard1&&egret.Tween.get(this._mCard1).to({x:n,y:a},500).call(function(){this._gameScene.removeChildren()},this)},t}();__reflect(SendCardAnimal.prototype,"SendCardAnimal");var ConfigData=function(){function t(){}return t.CARDWIDTH=139,t.CARDHEIGHT=189,t.LEFTGAP=270,t.DOWNGAP=98,t.VERCARGAP=35,t.HORCARGAP=60,t.SHOWCARDWIDTH=90,t.RECONECTTIME=10,t.SOUND=0,t.MUSIC=1,t.EFFECT=2,t.POKER=3,t.ELSE=3,t.DEBUG=!1,t}();__reflect(ConfigData.prototype,"ConfigData");var ConstData=function(){function t(){}return t.GAME_CONTROLLER="1001",t.UI_CONTROLLER="1002",t.NET_CONTROLLER="1003",t.BATTLE_CONTROLLER="1004",t.NIUNIU_BATTLE_CONTROLLER="1005",t.BAI_NIUNIU_BATTLE_CONTROLLER="1006",t.SOUND_CONTROLLER="1007",t.PLAYER_PROXY="1201",t.PLAYER_EKT="1401",t.DIZHU_CARD_LIST="1402",t.PLAYER_CARD_LIST="1403",t.PLAYER_BALANCE="1404",t.GAME_INIT_GAME_LAYER="2001",t.GAME_GET_LAYER="2002",t.GAME_ENTER_GAME="2003",t.GAME_CLEAR_ALL_LAYER="2004",t.GAME_DESTROY="2005",t.GAME_SET_PLAYER="2006",t.UI_GET_VIEW_BY_NAME="3001",t.UI_SHOW_VIEW_BY_NAME="3002",t.UI_REMOVE_VIEW_BY_NAME="3003",t.UI_REMOVE_ALL_VIEW="3004",t.UI_DESTROY_VIEW_BY_NAME="3005",t.UI_DESTROY_ALL_VIEW="3006",t.UI_ADD_WAIT="3007",t.UI_REMOVE_WAIT="3008",t.UI_ADD_TIP="3009",t.UI_REMOVE_TIP="3010",t.UI_SHOW_OVER="3011",t.UI_GET_CURRENT_VIEW="3012",t.NET_LOGIN="4001",t.NET_CONNECT="4002",t.NET_CLOSE="4003",t.NET_READDATA="4004",t.NET_ADDLISTENER="4005",t.NET_SENDDATA="4006",t.NET_SHOWSTATE="4007",t.NET_CLEAR_HEART_BEAT="4008",t.NET_DESTROY="4009",t.NET_OVER_CLOSE="4010",t.NET_REGISTER="4011",t.BATTLE_MATCH_PLAYERS="5002",t.BATTLE_SET_CARD="5003",t.BATTLE_JIA_BEI="5005",t.BATTLE_JIA_BEI_RESULT="5006",t.BATTLE_GRAB_SUCCESS="5007",t.BATTLE_PLAY_GAME="5008",t.BATTLE_GAME_OVER="5009",t.BATTLE_CALL_LANDlORD="5010",t.BATTLE_ON_PLAY_CARD="5011",t.BATTLE_ON_PASS_CARD="5012",t.BATTLE_CARD_ERROR="5013",t.BATTLE_CLEAR="5014",t.BATTLE_RECON_GAME="5015",t.BATTLE_SCORE_CHANGE="5016",t.BATTLE_RETURN_GROUND="5017",t.BATTLE_PLAY_ERROR="5018",t.BATTLE_CLOSE_MATCH_TIMER="5019",t.BATTLE_GET_CARDS="5020",t.BATTLE_INVAILD="5021",t.BATTLE_JOIN_TABLE="5022",t.BATTLE_CHAT="5023",t.BATTLE_ROLE_GRAB="5024",t.BATTLE_NIU_MATCH_PLAYERS="5051",t.BATTLE_NIU_SET_CARD="5052",t.BATTLE_NIU_GRAB_SUCCESS="5056",t.BATTLE_NIU_JIESUAN="5058",t.BATTLE_NIU_CALL_LANDlORD="5059",t.BATTLE_NIU_CLEAR="5060",t.BATTLE_NIU_RECON_GAME="5061",t.BATTLE_NIU_SCORE_CHANGE="5062",t.BATTLE_NIU_RETURN_GROUND="5063",t.BATTLE_NIU_CLOSE_MATCH_TIMER="5065",t.BATTLE_NIU_INVAILD="5067",t.BATTLE_NIU_ROOM_ROLE_CHANGE="5068",t.BATTLE_NIU_XIAZHU="5070",t.BATTLE_NIU_QIANG_ZHUANG_BROAD="5071",t.BATTLE_BAI_NIU_MATCH_PLAYERS="5090",t.BATTLE_BAI_NIU_JIESUAN="5091",t.BATTLE_BAI_NIU_CALL_LANDlORD="5092",t.BATTLE_BAI_NIU_CLEAR="5093",t.BATTLE_BAI_NIU_RECON_GAME="5094",t.BATTLE_BAI_NIU_SCORE_CHANGE="5095",t.BATTLE_BAI_NIU_RETURN_GROUND="5096",t.BATTLE_BAI_NIU_CLOSE_MATCH_TIMER="5097",t.BATTLE_BAI_NIU_INVAILD="5098",t.BATTLE_BAI_NIU_ROOM_ROLE_CHANGE="5099",t.BATTLE_BAI_NIU_BROAD_XIAZHU="5100",t.BATTLE_BAI_NIU_XIAZHU="5101",t.BATTLE_BAI_NIU_QIANG_ZHUANG_BROAD="5102",t.BATTLE_BAI_NIU_GRAB_SUCCESS="5103",t.SOUND_PLAY_MUSIC="6001",t.SOUND_PLAY_SOUND="6002",t.SOUND_PLAY_EFFECT="6003",t.SOUND_PLAY_POKER="6004",t.SOUND_STOP_SOUND="6005",t.SOUND_STOP_ALL_SOUND="6006",t.SOUND_PLAY_ONCE="6007",t.SOUND_SET_IS_BACK="6008",t.SOUND_IS_PLAY_SND="6009",t.SOUND_IS_PLAY_MUSIC="6010",t.SOUND_GET_PLAY_SND="6011",t.SOUND_GET_PLAY_MUSIC="6012",t.LOGIN_VIEW="8001",t.HALL_VIEW="8002",t.GROUND_VIEW="8003",t.PREGAME_VIEW="8004",t.BATTLE_VIEW="8005",t.WIN_VIEW="8006",t.LOSE_VIEW="8007",t.WAIT_VIEW="8008",t.TIP_VIEW="8009",t.RECHARGE_VIEW="8010",t.CASH_VIEW="8011",t.MATCH_END_VIEW="8012",t.GAME_RULE_VIEW="8013",t.NIUNIU_LOADING_VIEW="8014",t.NIUNIU_GROUND_VIEW="8015",t.NIUNIU_BATTLE_VIEW="8016",t.BAIREN_NIUNIU_GROUND_VIEW="8017",t.BAIREN_NIUNIU_BATTLE_VIEW="8018",t.UI_LAYER="9001",t.ANIMATE_LAYER="9002",t.EFFECT_LAYER="9003",t.TOP_LAYER="9004",t
}();__reflect(ConstData.prototype,"ConstData");var CurCards=function(){function t(t,e,n){void 0===t&&(t=-1),void 0===e&&(e=-1),void 0===n&&(n=[]),this.type=-1,this.header=-1,this.cards=[],this.type=t,this.header=e,this.cards=n}return t}();__reflect(CurCards.prototype,"CurCards");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var Player=function(){function t(){this._baseNum=10,this._cardList=[],this._dizhuCardList=[],this._roomId=0,this._seatNo=-1,this._leftSeatNo=-1,this._rightSeatNo=-1,this._dizhuSeatNo=-1,this._addr=(new Date).getTime()+"",this._curCards=new CurCards,this._onMyTurn=!1,this._myPlayCards=[],this._isPlay=!1,this._roleRoomList=[],this._channel=CommandChannel.instance;for(var t=0;3>t;t++)this._dizhuCardList.push(new Card(0));this.dizhuIndexList=[0,0,0]}return Object.defineProperty(t,"instance",{get:function(){return t._instance?t._instance:(t._instance=new t,t._instance)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleId",{get:function(){return this._roleId},set:function(t){this._roleId=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nickName",{get:function(){return this._nickName},set:function(t){this._nickName=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gold",{get:function(){return this._gold},set:function(t){this._gold=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"copper",{get:function(){return this._copper},set:function(t){this._copper=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baseNum",{get:function(){return this._baseNum},set:function(t){this._baseNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minEkt",{get:function(){return this._minEkt},set:function(t){this._minEkt=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timesNum",{get:function(){return this._timesNum},set:function(t){this._timesNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardList",{get:function(){return this._cardList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardIndexList",{set:function(t){for(var e=t.length,n=0;e>n;n++)this._cardList.push(CardUtils.instance.getCardFromPool(t[n],ConfigData.CARDWIDTH,ConfigData.CARDHEIGHT));this._cardList.sort(function(t,e){return e.point-t.point})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleRoomList",{get:function(){return this._roleRoomList},enumerable:!0,configurable:!0}),t.prototype.addDizhuList=function(){this.cardIndexList=[this.dizhuCardList[0].index,this.dizhuCardList[1].index,this.dizhuCardList[2].index]},Object.defineProperty(t.prototype,"dizhuCardList",{get:function(){return this._dizhuCardList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dizhuIndexList",{set:function(t){for(var e=t.length,n=0;e>n;n++)this._dizhuCardList[n].index=parseInt(t[n]),this._dizhuCardList[n].setWidth(90),this._dizhuCardList[n].setHeight(124)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLandlord",{get:function(){return this._seatNo==this._dizhuSeatNo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roomId",{get:function(){return this._roomId},set:function(t){this._roomId=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"seatNo",{get:function(){return this._seatNo},set:function(t){this._seatNo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftSeatNo",{get:function(){return this._leftSeatNo},set:function(t){this._leftSeatNo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightSeatNo",{get:function(){return this._rightSeatNo},set:function(t){this._rightSeatNo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dizhuSeatNo",{get:function(){return this._dizhuSeatNo},set:function(t){this._dizhuSeatNo=t,this._dizhuSeatNo==this._seatNo&&this.addDizhuList()},enumerable:!0,configurable:!0}),t.prototype.setDizhuSeatNo=function(t){this._dizhuSeatNo=t},Object.defineProperty(t.prototype,"addr",{get:function(){return this._addr},set:function(t){this._addr=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"curCards",{get:function(){return this._curCards},set:function(t){t.cards.length>0&&(this._curCards=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onMyTurn",{get:function(){return this._onMyTurn},set:function(t){this._onMyTurn=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myPlayCards",{get:function(){return this._myPlayCards},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlay",{get:function(){return this._isPlay},set:function(t){this._isPlay=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addRole",{set:function(t){for(var e=0;e<this._roleRoomList.length;e++)if(this._roleRoomList[e].roleId==t.roleId)return;this._roleRoomList.push(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"landId",{get:function(){return this._landId},set:function(t){this._landId=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLand",{get:function(){return this._roleId==this._landId},enumerable:!0,configurable:!0}),t.prototype.getSeatNoByRoleId=function(t){for(var e=0;e<this._roleRoomList.length;e++)if(this._roleRoomList[e].roleId==t)return this._roleRoomList[e].index+1},t.prototype.removeCards=function(){for(var t=0;t<this._myPlayCards.length;t++){var e=this._myPlayCards[t],n=this._cardList.indexOf(e);n>=0&&this._cardList.splice(n,1),e.parent&&e.parent.removeChild(e),CardUtils.instance.addCardToPool(e)}this._myPlayCards.splice(0,this._myPlayCards.length),this._cardList.sort(function(t,e){return e.point-t.point})},t.prototype.clear=function(){for(var t,e=0,n=0;3>n;n++)this._dizhuCardList[n].alpha=1,this._dizhuCardList[n].index=0;for(t=this._cardList.length,e=0;t>e;e++)CardUtils.instance.addCardToPool(this._cardList[e]);this._cardList.splice(0,t),this._myPlayCards.splice(0,this._myPlayCards.length),this._onMyTurn=!1,this._curCards.cards.splice(0,this._curCards.cards.length),this._curCards.type=-1,this._curCards.header=-1,this._dizhuSeatNo=-1,this._isPlay=!1},t.prototype.clearRoom=function(){this._roleRoomList.splice(0,this._roleRoomList.length)},t.prototype.destroy=function(){t._instance=null,this._channel=null,this._channel=null,this._cardList=null,this._dizhuCardList=null,this._addr=null,this._curCards=null,this._myPlayCards=null},t}();__reflect(Player.prototype,"Player");var PlayerProxy=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.init=function(){this.funcListObj[ConstData.PLAYER_EKT]=[],this.funcListObj[ConstData.PLAYER_BALANCE]=[],this.funcListObj[ConstData.DIZHU_CARD_LIST]=[],this.funcListObj[ConstData.PLAYER_CARD_LIST]=[]},e}(DataProxy);__reflect(PlayerProxy.prototype,"PlayerProxy");var BaseMsg=function(){function t(){}return t}();__reflect(BaseMsg.prototype,"BaseMsg");var NetCommands=function(){function t(){}return t.MSG_TYPE_OF_READY=0,t.MSG_TYPE_OF_UN_READY=1,t.MSG_TYPE_OF_JOIN_TABLE=2,t.MSG_TYPE_OF_LEAVE_TABLE=3,t.MSG_TYPE_OF_LOGIN="1001",t.MSG_TYPE_OF_ROLE_INFO="1004",t.MSG_TYPE_OF_QUIT="2003",t.MSG_TYPE_OF_MATCH="3001",t.MSG_TYPE_OF_PASS=6,t.MSG_TYPE_OF_SEND_CARD="3010",t.MSG_TYPE_OF_ENTER_ROOM="3006",t.MSG_TYPE_OF_ROLE_CHANGE="3008",t.MSG_TYPE_OF_CALL_SCORE="3012",t.MSG_TYPE_OF_DO_GRAB="3013",t.MSG_TYPE_OF_ROLE_GRAB="3014",t.MSG_TYPE_OF_SEND_BOTTOM_CARDS="3016",t.MSG_TYPE_OF_SCORE_CHANGE="3018",t.MSG_TYPE_OF_TIME_TICKER="3020",t.MSG_TYPE_OF_PLAY_CARD="3021",t.MSG_TYPE_OF_PLAY_CARD_SUCCESS="3024",t.MSG_TYPE_OF_JIA_BEI="3030",t.MSG_TYPE_OF_CALL_JIA_BEI="3031",t.MSG_TYPE_OF_JIA_BEI_RESULT="3032",t.MSG_TYPE_OF_PLAY_ERROR=12,t.TYPE_OF_TABLE_BRODCAST=14,t.MSG_TYPE_OF_GAME_OVER="3028",t.MSG_TYPE_OF_GAME_PREPARE="3029",t.MSG_TYPE_WS_CLOSE=21,t.MSG_TYPE_OF_PASS_CARD_SUCCESS=24,t.MSG_TYPE_OF_RECON_GAME=25,t.MSG_TYPE_OF_PVP_SUCCESS=26,t.MSG_TYPE_OF_HEART_BEAT=27,t.MSG_TYPE_OF_GET_CARDS=28,t.MSG_TYPE_OF_INVAILD=29,t.MSG_TYPE_OF_OVER=30,t.MSG_TYPE_OF_CHAT=31,t.NIUNIU_MATCH="4001",t.NIUNIU_MATCH_RESULT="4002",t.NIUNIU_EXIT="4003",t.NIUNIU_EXIT_SUCCESS="4004",t.NIUNIU_ENTER_ROOM="4006",t.NIUNIU_ROLE_CHANGE="4008",t.NIUNIU_SEND_CARD="4010",t.NIUNIU_CALL_SCORE="4012",t.NIUNIU_DO_GRAB="4013",t.NIUNIU_QIANG_ZHUANG_BROAD="4014",t.NIUNIU_ROLE_GRAB_ID="4016",t.NIUNIU_ROLE_XIAZHU_BROAD="4018",t.NIUNIU_ROLE_XIAZHU="4019",t.NIUNIU_ROLE_XIAZHU_RESULT="4020",t.NIUNIU_ROOM_SCORE="4022",t.NIUNIU_JIESUAN="4024",t.NIUNIU_PREPARE="4025",t.BAI_NIUNIU_MATCH="5001",t.BAI_NIUNIU_MATCH_RESULT="5002",t.BAI_NIUNIU_EXIT="5003",t.BAI_NIUNIU_EXIT_SUCCESS="5004",t.BAI_NIUNIU_ENTER_ROOM="5006",t.BAI_NIUNIU_ROLE_CHANGE="5008",t.BAI_NIUNIU_ROLE_GRAB_ID="5010",t.BAI_NIUNIU_REQUEST_GRAB="5011",t.BAI_NIUNIU_GRAB_LIST="5012",t.BAI_NIUNIU_ROLE_XIAZHU_BROAD="5014",t.BAI_NIUNIU_ROLE_XIAZHU="5015",t.BAI_NIUNIU_ROLE_XIAZHU_RESULT="5016",t.BAI_NIUNIU_ROOM_SCORE="5018",t.BAI_NIUNIU_JIESUAN="5020",t.BAI_NIUNIU_PREPARE="5021",t}();__reflect(NetCommands.prototype,"NetCommands");var ProtoRegister=function(){function t(){this._protoHash={},this._serverResHash={},this._logicHash={},this._channel=CommandChannel.instance,this._protoHash[NetCommands.MSG_TYPE_OF_LOGIN]=com.protobuff.data.LoginModule,this._protoHash[1002]=com.protobuff.data.LoginResultModule,this._protoHash[NetCommands.MSG_TYPE_OF_ROLE_INFO]=com.protobuff.data.RoleInfoModule,this._logicHash[NetCommands.MSG_TYPE_OF_ROLE_INFO]=new RoleInfoModuleLogic(this._channel),this._protoHash[1005]=com.protobuff.data.ReconnectionModule,this._protoHash[1006]=com.protobuff.data.ReconnectionResult,this._protoHash[1040]=com.protobuff.data.TipsModule,this._protoHash[1042]=com.protobuff.data.ResultErrorModule,this._protoHash[1101]=com.protobuff.data.HeartModule,this._protoHash[1102]=com.protobuff.data.HeartResultModule,this._protoHash[1044]=com.protobuff.data.KickOffRoleModule,this._protoHash[1045]=com.protobuff.data.DisConnectionModule,this._protoHash[NetCommands.MSG_TYPE_OF_MATCH]=com.protobuff.data.RequestMatchModule,this._protoHash[3002]=com.protobuff.data.RequestMatchResultModule,this._protoHash[2003]=com.protobuff.data.QuitModule,this._protoHash[3004]=com.protobuff.data.QuitResultModule,this._protoHash[NetCommands.MSG_TYPE_OF_ENTER_ROOM]=com.protobuff.data.EnterRoomModule,this._logicHash[NetCommands.MSG_TYPE_OF_ENTER_ROOM]=new EnterRoomModuleLogic(this._channel),this._protoHash[NetCommands.MSG_TYPE_OF_ROLE_CHANGE]=com.protobuff.data.RoleChangeModule,this._logicHash[NetCommands.MSG_TYPE_OF_ROLE_CHANGE]=new RoleChangeModuleLogic(this._channel),this._protoHash[NetCommands.MSG_TYPE_OF_SEND_CARD]=com.protobuff.data.StartModule,this._logicHash[NetCommands.MSG_TYPE_OF_SEND_CARD]=new StartModuleLogic(this._channel),this._protoHash[NetCommands.MSG_TYPE_OF_CALL_SCORE]=com.protobuff.data.GrabModule,this._logicHash[NetCommands.MSG_TYPE_OF_CALL_SCORE]=new GrabModuleLogic(this._channel),this._protoHash[3013]=com.protobuff.data.DoGrabModule,this._protoHash[3014]=com.protobuff.data.RoleGrabModule,this._protoHash[3016]=com.protobuff.data.LandModule,this._protoHash[3018]=com.protobuff.data.RoomCritModule,this._protoHash[3020]=com.protobuff.data.GoModule,this._protoHash[3021]=com.protobuff.data.StartGoModule,this._protoHash[3022]=com.protobuff.data.StartGoResultModule,this._protoHash[3024]=com.protobuff.data.RoleStarGoModule,this._protoHash[3026]=com.protobuff.data.ResultModule,this._protoHash[3028]=com.protobuff.data.SettlementModule,this._protoHash[3029]=com.protobuff.data.RolePrepareModule,this._protoHash[3030]=com.protobuff.data.AddCritModule,this._protoHash[3031]=com.protobuff.data.DoAddCritModule,this._protoHash[3032]=com.protobuff.data.RoleAddCritModule,this._protoHash[NetCommands.NIUNIU_MATCH]=com.protobuff.data.NiuNiuRequestMatchModule,this._protoHash[NetCommands.NIUNIU_MATCH_RESULT]=com.protobuff.data.NiuNiuRequestMatchResultModule,this._protoHash[NetCommands.NIUNIU_EXIT]=com.protobuff.data.NiuNiuQuitModule,this._protoHash[NetCommands.NIUNIU_EXIT_SUCCESS]=com.protobuff.data.NiuNiuQuitResultModule,this._protoHash[NetCommands.NIUNIU_ENTER_ROOM]=com.protobuff.data.NiuNiuEnterRoomModule,this._logicHash[NetCommands.NIUNIU_ENTER_ROOM]=new NiuNiuEnterRoomModuleLogic(this._channel),this._protoHash[NetCommands.NIUNIU_ROLE_CHANGE]=com.protobuff.data.NiuNiuRoleChangeModule,this._logicHash[NetCommands.NIUNIU_ROLE_CHANGE]=new NiuNiuRoleChangeModuleLogic(this._channel),this._protoHash[NetCommands.NIUNIU_SEND_CARD]=com.protobuff.data.NiuNiuStartModule,this._protoHash[NetCommands.NIUNIU_CALL_SCORE]=com.protobuff.data.NiuNiuGrabModule,this._protoHash[NetCommands.NIUNIU_DO_GRAB]=com.protobuff.data.NiuNiuDoGrabModule,this._protoHash[NetCommands.NIUNIU_QIANG_ZHUANG_BROAD]=com.protobuff.data.NiuNiuRoleGrabModule,this._protoHash[NetCommands.NIUNIU_ROLE_GRAB_ID]=com.protobuff.data.NiuNiuLandModule,this._protoHash[NetCommands.NIUNIU_ROLE_XIAZHU_BROAD]=com.protobuff.data.NiuNiuAddCritModule,this._protoHash[NetCommands.NIUNIU_ROLE_XIAZHU]=com.protobuff.data.NiuNiuDoAddCritModule,this._protoHash[NetCommands.NIUNIU_ROLE_XIAZHU_RESULT]=com.protobuff.data.NiuNiuRoleAddCritModule,this._protoHash[NetCommands.NIUNIU_ROOM_SCORE]=com.protobuff.data.NiuNiuRoomCritModule,this._protoHash[NetCommands.NIUNIU_JIESUAN]=com.protobuff.data.NiuNiuSettlementModule,this._protoHash[NetCommands.NIUNIU_PREPARE]=com.protobuff.data.NiuNiuRolePrepareModule,this._protoHash[NetCommands.BAI_NIUNIU_MATCH]=com.protobuff.data.HdNiuNiuRequestMatchModule,this._protoHash[NetCommands.BAI_NIUNIU_MATCH_RESULT]=com.protobuff.data.HdNiuNiuRequestMatchResultModule,this._protoHash[NetCommands.BAI_NIUNIU_EXIT]=com.protobuff.data.HdNiuNiuQuitModule,this._protoHash[NetCommands.BAI_NIUNIU_EXIT_SUCCESS]=com.protobuff.data.HdNiuNiuQuitResultModule,this._protoHash[NetCommands.BAI_NIUNIU_ENTER_ROOM]=com.protobuff.data.HdNiuNiuEnterRoomModule,this._logicHash[NetCommands.BAI_NIUNIU_ENTER_ROOM]=new BairenNiuNiuEnterRoomModuleLogic(this._channel),this._protoHash[NetCommands.BAI_NIUNIU_ROLE_CHANGE]=com.protobuff.data.HdNiuNiuRoleChangeModule,this._logicHash[NetCommands.BAI_NIUNIU_ROLE_CHANGE]=new BairenNiuNiuRoleChangeModuleLogic(this._channel),this._protoHash[NetCommands.BAI_NIUNIU_ROLE_GRAB_ID]=com.protobuff.data.HdLandModule,this._protoHash[NetCommands.BAI_NIUNIU_REQUEST_GRAB]=com.protobuff.data.HdAddLandModule,this._protoHash[NetCommands.BAI_NIUNIU_GRAB_LIST]=com.protobuff.data.HdLandListModule,this._protoHash[NetCommands.BAI_NIUNIU_ROLE_XIAZHU_BROAD]=com.protobuff.data.HdNiuNiuAddCritModule,this._protoHash[NetCommands.BAI_NIUNIU_ROLE_XIAZHU]=com.protobuff.data.HdNiuNiuDoAddCritModule,this._protoHash[NetCommands.BAI_NIUNIU_ROLE_XIAZHU_RESULT]=com.protobuff.data.HdNiuNiuRoleAddCritModule,this._protoHash[NetCommands.BAI_NIUNIU_ROOM_SCORE]=com.protobuff.data.HdNiuNiuRoomCritModule,this._protoHash[NetCommands.BAI_NIUNIU_JIESUAN]=com.protobuff.data.HdNiuNiuSettlementModule,this._protoHash[NetCommands.BAI_NIUNIU_PREPARE]=com.protobuff.data.HdNiuNiuRolePrepareModule}return Object.defineProperty(t,"Ins",{get:function(){return this._ins||(this._ins=new t,this._ins)},enumerable:!0,configurable:!0}),t.prototype.decode=function(t,e){if(this._protoHash[t]){var n=this._protoHash[t].decode(new Uint8Array(e));n.MsgType=t,this._serverResHash[t]=n,this._logicHash[t]&&this._logicHash[t].decode(n),this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_READDATA,n)}},t.prototype.setMessage=function(t,e){void 0===e&&(e={});var n=this._protoHash[t],a=(new n,n.create(e)),i=n.encode(a).finish(),o=new egret.ByteArray,s=new egret.ByteArray(i);o.writeBytes(ByteIntUtils.int2Bytes(4+s.length)),o.writeBytes(ByteIntUtils.int2Bytes(t)),o.writeBytes(s),o.position=0,this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_SENDDATA,[o])},t}();__reflect(ProtoRegister.prototype,"ProtoRegister");var WS=function(){function t(t){this.isBin=!0,this._heartBeatMsg=new BaseMsg,this.heartDelay=0,this._heartId=null,this.cache=new egret.ByteArray,this._channel=t,this._heartBeatMsg.MsgType=NetCommands.MSG_TYPE_OF_HEART_BEAT}return t.prototype.login=function(){var t;t=new egret.HttpRequest,t.responseType=egret.HttpResponseType.TEXT,t.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this),t.open("http://39.98.216.22:21080/cgi-bin/server",egret.HttpMethod.POST),t.setRequestHeader("Content-type","application/x-www-form-urlencoded");var e=Date.now();t.send("openId="+e+"&version=1.0.0&channelId=1")},t.prototype.test=function(){if(this.webSocket&&this.webSocket.connected)ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_MATCH,{type:1});else{var t="ws://39.98.216.22:15001/ws";this.connectByUrl(t)}},t.prototype.onPostComplete=function(t){var e=t.currentTarget;egret.log("post data : ",e.response);var n=JSON.parse(e.response);if(n&&0==n.code){this._loginInfoObj=n,this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.LOGIN_VIEW,!0]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.HALL_VIEW,0,0,ConstData.UI_LAYER]);var a="ws://"+n.serverIp+":"+n.serverPort+"/ws";this.connectByUrl(a)}},t.prototype.onPostIOError=function(t){},t.prototype.register=function(){var t=new XMLHttpRequest;t.onload=function(t){alert(t.data)},t.onerror=function(t){alert("请求错误")},t.open("POST","http://192.168.2.214:8080/cgi-bin/register"),t.setRequestHeader("Content-type","application/json");var e={openId:"123456",password:"123456"};t.send(JSON.stringify(e))},t.prototype.connectByUrl=function(t){this.webSocket||(this.webSocket=new egret.WebSocket,this.webSocket.type=this.isBin?egret.WebSocket.TYPE_BINARY:egret.WebSocket.TYPE_STRING,this.webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.webSocket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.webSocket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.webSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)),!this.webSocket.connected&&this.webSocket.connectByUrl(t)},t.prototype.connect=function(t,e){this.webSocket||(this.webSocket=new egret.WebSocket,this.webSocket.type=this.isBin?egret.WebSocket.TYPE_BINARY:egret.WebSocket.TYPE_STRING,this.webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.webSocket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.webSocket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.webSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)),!this.webSocket.connected&&this.webSocket.connect(t,e)},t.prototype.close=function(){this.webSocket.close()},t.prototype.onReceiveMessage=function(t){if(this.isBin){var e=new egret.ByteArray;this.webSocket.readBytes(e);var n=(e.dataView.getInt32(0),e.dataView.getInt32(4));ProtoRegister.Ins.decode(n,e.buffer.slice(8))}else{this.webSocket.readUTF()}},t.prototype.read=function(t,e){},t.prototype.sendData=function(t){this.isBin&&(this.webSocket.writeBytes(t,0,t.bytesAvailable),this.webSocket.flush())},t.prototype.clearHeartBeat=function(){clearInterval(this._heartId)},t.prototype.onSocketOpen=function(){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT),this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_SHOWSTATE,"socket 连接上了");var t={openId:this._loginInfoObj.loginOpenId,channelId:"1",nickname:"jiluo",imgurl:"",sex:1,device:""};ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_LOGIN,t)},t.prototype.onSocketClose=function(e){this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_SHOWSTATE,"socket 关闭了");var n=this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_CURRENT_VIEW);n==ConstData.BATTLE_VIEW&&Player.instance.baseNum>0&&t.connectTime<1},t.prototype.onSocketError=function(e){this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_SHOWSTATE,"socket error");var n=this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_GET_CURRENT_VIEW);n==ConstData.BATTLE_VIEW&&Player.instance.baseNum>0&&t.connectTime<1},t.prototype.destroy=function(){this._channel=null,this._heartBeatMsg=null,this.webSocket&&(this.webSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.webSocket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.webSocket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.webSocket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this),this.webSocket=null)},t.heartBeatCount=0,t.connectTime=0,t}();__reflect(WS.prototype,"WS");var BairenNiuNiuEnterRoomModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){for(var e=0;e<t.roleList.length;e++){var n=t.roleList[e];Player.instance.addRole=n}this._channel.postCommand(ConstData.BAI_NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_BAI_NIU_ROOM_ROLE_CHANGE,t)},t}();__reflect(BairenNiuNiuEnterRoomModuleLogic.prototype,"BairenNiuNiuEnterRoomModuleLogic");var BairenNiuNiuRoleChangeModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){t.role;0==t.type||(Player.instance.addRole=t.role)},t}();__reflect(BairenNiuNiuRoleChangeModuleLogic.prototype,"BairenNiuNiuRoleChangeModuleLogic");var EnterRoomModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){for(var e=0;e<t.roleList.length;e++){var n=t.roleList[e];n.roleId==Player.instance.roleId&&(Player.instance.seatNo=n.index+1),Player.instance.addRole=n}},t}();__reflect(EnterRoomModuleLogic.prototype,"EnterRoomModuleLogic");var GrabModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){},t}();__reflect(GrabModuleLogic.prototype,"GrabModuleLogic");var RequestMatchResultModuleLogic=function(){function t(){}return t.prototype.decode=function(){},t}();__reflect(RequestMatchResultModuleLogic.prototype,"RequestMatchResultModuleLogic");var RoleChangeModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){var e=t.role;e.roleId==Player.instance.roleId&&(Player.instance.seatNo=e.index+1),0==t.type||(Player.instance.addRole=t.role)},t}();__reflect(RoleChangeModuleLogic.prototype,"RoleChangeModuleLogic");var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){document.bgColor="#0d1b51",t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),this.stage.setContentSize(1920,1080),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,RES.loadGroup("loading")];case 2:return n.sent(),ConfigData.stageWidth=this.stage.stageWidth,ConfigData.stageHeight=this.stage.stageHeight,this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL,t=new LoadingView,this.addChild(t),[4,this.loadTheme()];case 3:return n.sent(),[4,RES.loadGroup("preload",0,t)];case 4:return n.sent(),[3,6];case 5:return e=n.sent(),console.error(e),[3,6];case 6:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var a=new eui.Theme("resource/default.thm.json",t.stage);a.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){this.addChild(Game.instance)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var StartModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){},t}();__reflect(StartModuleLogic.prototype,"StartModuleLogic");var NiuNiuEnterRoomModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){for(var e=0;e<t.roleList.length;e++){var n=t.roleList[e];Player.instance.addRole=n}this._channel.postCommand(ConstData.BAI_NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_BAI_NIU_ROOM_ROLE_CHANGE,t)},t}();__reflect(NiuNiuEnterRoomModuleLogic.prototype,"NiuNiuEnterRoomModuleLogic");var NiuNiuRoleChangeModuleLogic=function(){function t(t){this._channel=t}return t.prototype.decode=function(t){var e=t.role;e.roleId==Player.instance.roleId,0==t.type||(Player.instance.addRole=t.role,this._channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_ROOM_ROLE_CHANGE))},t}();__reflect(NiuNiuRoleChangeModuleLogic.prototype,"NiuNiuRoleChangeModuleLogic");var ByteIntUtils=function(){function t(){}return t.bytes2Int=function(t){var e=0;return e=255&t[0],e=e<<8|255&t[1],e=e<<8|255&t[2],e=e<<8|255&t[3]},t.int2Bytes=function(t){var e=new egret.ByteArray;return e.writeByte(t>>>24),e.writeByte(t>>>16),e.writeByte(t>>>8),e.writeByte(t),e},t}();__reflect(ByteIntUtils.prototype,"ByteIntUtils");var GameTools=function(){function t(){}return t.addGrayFilter=function(t){for(var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],n=new egret.ColorMatrixFilter(e),a=0;a<t.length;a++)t[a]&&(t[a].filters=[n])},t}();__reflect(GameTools.prototype,"GameTools");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,a){function i(t){e.call(a,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(a))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(a,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(a,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var r=t.split("/");r.pop();var _=r.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(a,generateJSON.paths[t])},this):RES.getResByUrl(_,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(a,generateJSON.paths[t])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(a,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Battle=function(t){function e(e){var n=t.call(this)||this;return n._myCardBox=null,n._dizhuCardBox=null,n.my_card_box=new egret.Sprite,n.left_card_box=new egret.Sprite,n.right_card_box=new egret.Sprite,n._gap=32,n._horizontalNum=9,n._maxHorizontalWidth=0,n.talkTime=0,n.talkObj={item_0:"快点吧，等到花儿都谢了～",item_1:"刚刚手抖了，不好意思哈！",item_2:"你的牌打得也太好了！",item_3:"这一手牌，有毒啊～～～",item_4:"和你合作真的是太愉快了",item_5:"不要走，我们决战到天亮",item_6:"再见了，我会再回来的！",item_7:"不好意思，我要离开一会儿"},n._isSendOver=!1,n._scoreObj={1:0,2:0,3:0},n._nowSeatNo=999,n._startPlay=!1,n._dx=0,n._oldX=0,n._nowDir=0,n._dir=0,n._startX=0,n._move=!1,n._nowPlaySeatNo=999,n._playTime=-99,n._channel=e,n._player=Player.instance,n._myCardBox=new egret.Sprite,n._dizhuCardBox=new egret.Sprite,n._myCardBox.y=160,n.addChild(n._myCardBox),n.addChild(n._dizhuCardBox),n.addChild(n.left_card_box),n.addChild(n.my_card_box),n.my_card_box.x=0,n.my_card_box.y=530,n.addChild(n.right_card_box),n._dizhuBmp=new egret.Bitmap(RES.getRes("landLord_png")),n._dizhuBmp_small=new egret.Bitmap(RES.getRes("landLord_png")),n._dizhuBmp_small.width=62,n._dizhuBmp_small.height=63,n._maxHorizontalWidth=n._horizontalNum*n._gap+ConfigData.SHOWCARDWIDTH,n._grabTimer=new egret.Timer(1e3),n._grabTimer.addEventListener(egret.TimerEvent.TIMER,n.jiaodizhuFunc,n),n._jiabeiTimer=new egret.Timer(1e3),n._jiabeiTimer.addEventListener(egret.TimerEvent.TIMER,n.jiabeiFunc,n),n._gameTimer=new egret.Timer(1e3),n._gameTimer.addEventListener(egret.TimerEvent.TIMER,n.gameTimerFunc,n),n}return __extends(e,t),e.prototype.init=function(){this.setBalance(),this.call_txt&&(this.call_txt.visible=!1),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["battle_snd_mp3"]),this.snd_btn&&(this.snd_btn.selected=this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_GET_PLAY_SND)),this.music_btn&&(this.music_btn.selected=this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_GET_PLAY_MUSIC))},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){switch(e){case"snd_btn":this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_IS_PLAY_SND,this.snd_btn.selected);break;case"music_btn":this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_IS_PLAY_MUSIC,this.music_btn.selected)}},this)},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),CardUtils.instance.setPosByDir({left:{x:this.left_call_txt.x,y:this.left_call_txt.y},right:{x:this.right_call_txt.x,y:this.right_call_txt.y},my:{x:this.call_txt.x,y:this.call_txt.y}}),GameTools.addGrayFilter([this.tuoguan_btn]),this.right_card_box.x=this.right_head_img.x-this.right_head_img.width/2-50,this.right_card_box.y=144,this.left_card_box.x=this.left_head_img.x+this.left_head_img.width+50,this.left_card_box.y=144,this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["欢迎来到斗地主",500,-1,57]),this.play_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playCard,this),this.pass_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.passCard,this),this.tip_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tipCard,this),this.no_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.wantDizhu,this),this.score1_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.wantDizhu,this),this.score2_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.wantDizhu,this),this.score3_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.wantDizhu,this),this.jiabei_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jiabei,this),this.bujiabei_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jiabei,this),this.return_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.returnGround,this),this.talk_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),e.talk_bg.visible=!e.talk_bg.visible,e.talk_scroller.visible=!e.talk_scroller.visible},this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){console.log(t.target.name,t.currentTarget.name),t.target!=e.talk_btn&&t.target!=e.talk_group&&t.target.name.indexOf("item")<0&&(e.talk_bg.visible=!1,e.talk_scroller.visible=!1)},this),this.talk_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.talkFunc,this),this.setBalance(),this.addChild(this.talk_bg),this.addChild(this.talk_btn),this.addChild(this.talk_scroller)},e.prototype.talkFunc=function(t){var e=this.talkObj[t.target.name];if(e){var n=(new Date).getTime();if(n-this.talkTime<2500)return void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请不要频繁发送消息",500]);
this.talkTime=n;var a=new BaseMsg;a.MsgType=NetCommands.MSG_TYPE_OF_CHAT,a.Data={Chats:e},this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_SENDDATA,[a]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this.talk_bg.visible=!1,this.talk_scroller.visible=!1,this.setChat(this.my_talk,this.my_talk_txt,e)}},e.prototype.onBattleChat=function(t){var e=t.SeatNo+1;e!=this._player.seatNo&&(console.log(t,11111,this._player.seatNo),e==this._player.leftSeatNo?this.setChat(this.left_talk,this.left_talk_txt,t.Msg):e==this._player.rightSeatNo&&this.setChat(this.right_talk,this.right_talk_txt,t.Msg))},e.prototype.setChat=function(t,e,n){t.visible=!0,e.text=n,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_ONCE,["chat_snd_mp3"]),setTimeout(function(){return t.visible=!1},2500)},e.prototype.activate=function(t){if(void 0!=this._deacTime){var e=(new Date).getTime()-this._deacTime;e>18e3&&(this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_CLOSE),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_WAIT,"重连服务器......")),this._deacTime=void 0}},e.prototype.deactivate=function(t){this._deacTime=(new Date).getTime()},e.prototype.closeMatchTimer=function(){this._timer&&(this._timer.stop(),this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this))},e.prototype.removeView=function(){this.closeMatchTimer()},e.prototype.getCards=function(){},e.prototype.invaild=function(){this.clear(),this.returnGround(),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["对局无效，返回大厅"])},e.prototype.returnGround=function(){this._timer&&this._timer.stop(),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.GROUND_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.BATTLE_VIEW])},e.prototype.setMyCard=function(){this._myCardBox.removeChildren();var t=this._player.cardList,e=t.length,n=ConfigData.stageWidth-ConfigData.LEFTGAP-ConfigData.CARDWIDTH,a=n/(e-1);a>ConfigData.HORCARGAP&&(a=ConfigData.HORCARGAP);for(var i=ConfigData.LEFTGAP+(n-a*(e-1)-ConfigData.CARDWIDTH)/2,o=0;e>o;o++){var s=t[o];s.isSelect=!1,s.currentState=!1,s.onTouch=!1,s.touchEnabled=!0,s.y=528,s.x=i+o*a,this._myCardBox.addChild(s),o==e-1&&this._player.seatNo==this._player.dizhuSeatNo&&(s.addChild(this._dizhuBmp),this._dizhuBmp.x=s.width-this._dizhuBmp.width)}},e.prototype.matchPlayers=function(){this._timer||(this._timer=new egret.Timer(1e3)),this._timer.hasEventListener(egret.TimerEvent.TIMER)||this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._count=60,this.findTxt=AnimateManager.instance.createDragonBones(egret.MainContext.instance.stage,"Loading_ske_json","Loading_tex_json","Loading_tex_png").display,this.findTxt.x=ConfigData.stageWidth/2,this.findTxt.y=ConfigData.stageHeight/2,this._timer.start();var t={type:1};ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_MATCH,t)},e.prototype.joinTable=function(t){},e.prototype.exitTable=function(t){},e.prototype.onMatchPlayerBack=function(t){this.clear(),this.left_head_img.source=RES.getRes("man_head"),this.right_head_img.source=RES.getRes("man_head"),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.MATCH_END_VIEW]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_ONCE,["start_snd_mp3"]);var e=new Object;for(var n in t.PlayerIndexIdDic){var a=n.slice(0,4)+"..."+n.slice(n.length-4,n.length);e[t.PlayerIndexIdDic[n]]=a}this._player.leftSeatNo=this._player.seatNo-1<1?3:this._player.seatNo-1,this._player.rightSeatNo=this._player.seatNo+1>3?1:this._player.seatNo+1,this.setBalance(),this.right_name_txt.text=this._player.rightSeatNo+"号位",this.left_name_txt.text=this._player.leftSeatNo+"号位",this.findTxt.visible=!1},e.prototype.setBalance=function(){var t,e=parseFloat(this._player.gold),n=parseInt(e.toString().split(".")[0]);n>1e4?(t=(n/1e4).toFixed(2)+"万",this.my_name_txt&&(this.my_name_txt.text=t)):this.my_name_txt&&(this.my_name_txt.text=e+"")},e.prototype.onTimer=function(t){this._count--,this._count<=0&&(this.closeMatchTimer(),this.findTxt.visible=!1,this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.MATCH_END_VIEW,0,0,ConstData.UI_LAYER]))},e.prototype.clear=function(){this._nowSeatNo=999,this._nowPlaySeatNo=999,this._scoreObj={1:0,2:0,3:0},this.removeDiCard(),this._player.clear(),AnimateManager.instance.removeAnimate(),this.right_num_txt.text="17",this.left_num_txt.text="17",this.left_head_img.source=RES.getRes("man_head"),this.right_head_img.source=RES.getRes("man_head"),this.my_head_img.source=RES.getRes("man_head"),this.left_pass.visible=!1,this.right_pass.visible=!1,this.my_pass.visible=!1,this.call_txt.visible=!1,this.left_call_txt.visible=!1,this.right_call_txt.visible=!1,this.findTxt.visible=!1,this._isSendOver=!1,this.score1_btn.visible=!1,this.score2_btn.visible=!1,this.score3_btn.visible=!1,this.no_btn.visible=!1,this.my_clock.visible=!1,this.left_clock.visible=!1,this.right_clock.visible=!1,this.right_name_txt.text="?",this.left_name_txt.text="?",this.my_time_txt.text="",this.left_time_txt.text="",this.right_time_txt.text="",this.top_box.visible=!1,this._myCardBox.removeChildren(),this._dizhuCardBox.removeChildren(),this.left_card_box.removeChildren(),this.right_card_box.removeChildren(),this.my_card_box.removeChildren();for(var t=1;4>t;t++)this["card_"+t].source=RES.getRes("backPoker");this.left_num_box.visible=!1,this.right_num_box.visible=!1,this.play_btn.visible=!1,this.tip_btn.visible=!1,this.pass_btn.visible=!1,this.talk_bg.visible=!1,this.talk_scroller.visible=!1,this.left_talk.visible=!1,this.right_talk.visible=!1,this.my_talk.visible=!1,this._dizhuBmp.parent&&this._dizhuBmp.parent.removeChild(this._dizhuBmp),this._dizhuBmp_small.parent&&this._dizhuBmp_small.parent.removeChild(this._dizhuBmp_small)},e.prototype.reconGame=function(t){this.closeMatchTimer(),this.clear(),this.removeDiCard(),this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{seatNo:t.SeatNo+1}),this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{cardIndexList:t.Cards}),this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{baseNum:t.BaseNum}),t.DizhuCards&&this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{dizhuIndexList:t.DizhuCards}),this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{timesNum:t.crit}),this._player.setDizhuSeatNo(t.DizhuSeat+1);var e=this._player.seatNo;if(this._player.seatNo>0){void 0!=t.PlayerIndexIdDic[this._player.addr]&&(this._player.seatNo=t.PlayerIndexIdDic[this._player.addr]+1);var n=new Object;for(var a in t.PlayerIndexIdDic){var i=a.slice(0,4)+"..."+a.slice(a.length-4,a.length);n[t.PlayerIndexIdDic[a]]=i}this._player.leftSeatNo=this._player.seatNo-1<1?3:this._player.seatNo-1,this._player.rightSeatNo=this._player.seatNo+1>3?1:this._player.seatNo+1;var o=this._player.gold,s=parseInt(o.toString().split(".")[0]),r=void 0;s>1e4?(r=(s/1e4).toFixed(2)+"万",this.my_name_txt.text=r):this.my_name_txt.text=o+"",this.right_name_txt.text=n[this._player.rightSeatNo-1],this.left_name_txt.text=n[this._player.leftSeatNo-1]}this.left_name_txt.visible=!0,this.right_name_txt.visible=!0,this.setMyCard(),this.call_txt.visible=!1,this.no_btn.visible=!1,this.score1_btn.visible=!1,this.score2_btn.visible=!1,this.score3_btn.visible=!1,this.my_clock.visible=!1;var _=t.LeftCardNum;if(this._player.dizhuSeatNo>0){switch(this._player.dizhuSeatNo){case this._player.seatNo:this.setHeadImg(this.my_head_img,this.left_head_img,this.right_head_img);break;case this._player.leftSeatNo:this.setHeadImg(this.left_head_img,this.my_head_img,this.right_head_img);break;case this._player.rightSeatNo:this.setHeadImg(this.right_head_img,this.my_head_img,this.left_head_img)}for(var h=0;3>h;h++){var l=CardUtils.instance.getCardFromPool(Player.instance.dizhuCardList[h].index,54,76);l.touchEnabled=!1,l.y=8,l.x=575+h*(l.width+3),this._dizhuCardBox.addChild(l)}var c=t.LastCardInfo,d=e-1>0?e-1:3;if(c[d-1]&&0!=c[d-1].length)this._player.curCards=CardUtils.instance.getCurCardsByIds(c[d-1]);else{var u=4>e+1?e+1:1;c[u-1]&&c[u-1].length>0&&(this._player.curCards=CardUtils.instance.getCurCardsByIds(c[u-1]))}var C=void 0;for(C in c){var p=c[C];if(p&&0!=p.length){var m=CardUtils.instance.getCurCardsByIds(p);this.showCards(parseInt(C)+1,!1,m)}else this.showCards(parseInt(C)+1,!0)}this.setListener(!0),this.left_num_box.visible=!0,this.right_num_box.visible=!0,this.talk_btn.visible=!0}else{this.left_head_img.source=RES.getRes("man_head"),this.right_head_img.source=RES.getRes("man_head");for(var h=0;h<this._player.dizhuCardList.length;h++){var E=this._player.dizhuCardList[h];0==h?E.x=(ConfigData.stageWidth-90)/2-ConfigData.CARDWIDTH-10:1==h?E.x=(ConfigData.stageWidth-90)/2+ConfigData.CARDWIDTH+10:2==h&&(E.x=(ConfigData.stageWidth-90)/2),E.y=144,this.addChild(E)}}if(this.left_num_txt.text=_[this._player.leftSeatNo-1]+"",this.right_num_txt.text=_[this._player.rightSeatNo-1]+"",_[this._player.leftSeatNo-1]<3){var T=AnimateManager.instance.createAnimate("redAlert",1,this,-1,3);T.x=226,T.y=273}if(_[this._player.rightSeatNo-1]<3){var T=AnimateManager.instance.createAnimate("redAlert",1,this,-1,3);T.x=1050,T.y=273}this._isSendOver=!0},e.prototype.setCard=function(t){var e=this;this.talk_btn.visible=!0,this.closeMatchTimer(),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["游戏开始",500,-1,57]),this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{cardIndexList:CardUtils.instance.getIndexArr(t.cardList)}),SendCardAnimal.instance.startAnimal(this._player.dizhuCardList,this._myCardBox,function(){e._isSendOver=!0,e.top_box.visible=!0},this)},e.prototype.wantDizhu=function(t){void 0===t&&(t=null),this.stopTimer();var e=t?parseInt(t.target.name):0;ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_DO_GRAB,{type:e}),this.no_btn.visible=!1,this.score1_btn.visible=!1,this.score2_btn.visible=!1,this.score3_btn.visible=!1,this.jiabei_btn.visible=!1,this.bujiabei_btn.visible=!1,this.my_clock.visible=!1,this.call_txt.visible=!0,this.call_txt.source=RES.getRes(0==e?"bujiao":"jiaodizhu"),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["point"+e+"_snd_mp3"])},e.prototype.grabLandLordSuccess=function(t){var e=this._player.getSeatNoByRoleId(t.landId),n=CardUtils.instance.getIndexArr(t.cardList);this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{dizhuIndexList:n,dizhuSeatNo:e}),this.showDizhu(e,n),this.stopTimer()},e.prototype.isJiabei=function(t){this._currentData=t,this._jiabeiTimer.start(),this._currentTime_txt&&(this._currentTime_txt.text=""),t.roleId==this._player.roleId&&(this.my_clock.visible=!0,this.jiabei_btn.visible=this.bujiabei_btn.visible=!0)},e.prototype.jiabeiResult=function(t){if(t.roleId!=this._player.roleId){this._player.getSeatNoByRoleId(t.roleId);this.stopJiabeiTimer();var e=1==t.crit?"jiabei":"bujiabei";1==t.crit&&(this._player.timesNum*=2,this.beishu_txt.text=this._player.timesNum+""),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,[e+"_snd_mp3"])}},e.prototype.jiabei=function(t){void 0===t&&(t=null),this.stopTimer();var e=t.target.name;ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_CALL_JIA_BEI,{crit:"jiabei"==e?1:0}),this.no_btn.visible=!1,this.score1_btn.visible=!1,this.score2_btn.visible=!1,this.score3_btn.visible=!1,this.jiabei_btn.visible=!1,this.bujiabei_btn.visible=!1,this.my_clock.visible=!1,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,[e+"_snd_mp3"])},e.prototype.jiaodizhuFunc=function(){if(this._currentData){var t=this._currentData,e=t.waitTime--;e>20&&(e=20),0>e&&(e=0),this._currentTime_txt&&(this._currentTime_txt.text=e+"");var n=Player.instance.getSeatNoByRoleId(t.roleId);if(t.roleId==this._player.roleId&&(5==e&&this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["bibi_snd_mp3"]),0>=e&&(this._finishFunc&&this._finishFunc.call(this),this._finishFunc=null)),!(this._player.dizhuSeatNo>0)&&this._isSendOver&&this._nowSeatNo!=n&&(this._nowSeatNo=n,this.showRect(n,!0,e),this.setFinishFunc(n,1),t.roleId==this._player.roleId)){var a=0;for(var i in this._scoreObj)this._scoreObj[i]>a&&(a=this._scoreObj[i]);for(var i=1;4>i;i++)i>a?this["score"+i+"_btn"].visible=!0:this["score"+i+"_btn"].visible=!1,this.no_btn.visible=!0,this.my_clock.visible=!0}}},e.prototype.jiabeiFunc=function(){if(this._currentData){var t=this._currentData,e=t.waitTime--;e>20&&(e=20),0>e&&(e=0),this._currentTime_txt&&(this._currentTime_txt.text=e+"");var n=Player.instance.getSeatNoByRoleId(t.roleId);if(t.roleId==this._player.roleId&&(5==e&&this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["bibi_snd_mp3"]),0>=e&&(this._finishFunc&&this._finishFunc.call(this),this._finishFunc=null)),!(this._player.dizhuSeatNo>0)&&this._isSendOver&&this._nowSeatNo!=n&&(this._nowSeatNo=n,this.showRect(n,!0,e),this.setFinishFunc(n,2),t.roleId==this._player.roleId)){var a=0;for(var i in this._scoreObj)this._scoreObj[i]>a&&(a=this._scoreObj[i]);for(var i=1;4>i;i++)i>a?this["score"+i+"_btn"].visible=!0:this["score"+i+"_btn"].visible=!1,this.no_btn.visible=!0,this.my_clock.visible=!0}}},e.prototype.gameTimerFunc=function(){this._playTime--,this._currentTime_txt&&(this._currentTime_txt.text=this._playTime+""),this._currentRoleId==this._player.roleId&&(5==this._playTime&&this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_ONCE,["bibi_snd_mp3"]),this._playTime<=0&&(this._finishFunc&&this._finishFunc.call(this),this._finishFunc=null))},e.prototype.callLandLord=function(t){this._currentData=t,this._grabTimer.start(),this._currentTime_txt&&(this._currentTime_txt.text="");var e=(t.roleId,Player.instance.getSeatNoByRoleId(t.roleId)),n=t.type;if(this._scoreObj[e]=n,t.roleId==this._player.roleId){var a=0;for(var i in this._scoreObj)this._scoreObj[i]>a&&(a=this._scoreObj[i]);for(var i=1;4>i;i++)i>a?this["score"+i+"_btn"].visible=!0:this["score"+i+"_btn"].visible=!1,this.no_btn.visible=!0,this.my_clock.visible=!0}},e.prototype.roleGrab=function(t){this._currentTime_txt&&(this._currentTime_txt.text="");var e=t.roleId,n=Player.instance.getSeatNoByRoleId(t.roleId),a=t.type;this._scoreObj[n]=a,e!=this._player.roleId&&(this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["point"+a+"_snd_mp3"]),n==this._player.leftSeatNo?(this.left_call_txt.visible=!0,this.left_call_txt.source=RES.getRes(0==a?"bujiao":"jiaodizhu")):n==this._player.rightSeatNo&&(this.right_call_txt.visible=!0,this.right_call_txt.source=RES.getRes(0==a?"bujiao":"jiaodizhu")))},e.prototype.onScoreChange=function(t){this._player.timesNum=t.crit,this.beishu_txt.text=this._player.timesNum+""},e.prototype.stopTimer=function(){this._grabTimer.stop(),this._currentData=null},e.prototype.stopJiabeiTimer=function(){this._jiabeiTimer.stop(),this._currentData=null},e.prototype.showDizhu=function(t,e){this.call_txt.visible=!1,this.left_call_txt.visible=!1,this.right_call_txt.visible=!1,this.no_btn.visible=!1,this.score1_btn.visible=!1,this.score2_btn.visible=!1,this.score3_btn.visible=!1,this.jiabei_btn.visible=!1,this.bujiabei_btn.visible=!1,this.my_clock.visible=!1,this.left_num_box.visible=!0,this.right_num_box.visible=!0;switch(t){case this._player.seatNo:this.setHeadImg(this.my_head_img,this.left_head_img,this.right_head_img);break;case this._player.leftSeatNo:this.setHeadImg(this.left_head_img,this.my_head_img,this.right_head_img),this.left_num_txt.text="20",this.right_num_txt.text="17",this.setListener(!0);break;case this._player.rightSeatNo:this.setHeadImg(this.right_head_img,this.my_head_img,this.left_head_img),this.right_num_txt.text="20",this.left_num_txt.text="17",this.setListener(!0)}for(var n=1;4>n;n++)this["card_"+n].source=RES.getRes(Player.instance.dizhuCardList[n-1].index+"");this.finishDizhuAnimate()},e.prototype.removeDiCard=function(){for(var t=0;t<this._player.dizhuCardList.length;t++){var e=this._player.dizhuCardList[t];e.parent&&e.parent.removeChild(e)}},e.prototype.setListener=function(t){void 0===t&&(t=!1),this._myCardBox.touchEnabled=t,t?(this.stage.hasEventListener(egret.TouchEvent.TOUCH_BEGIN)||this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginFunc,this),this._myCardBox.hasEventListener(egret.TouchEvent.TOUCH_BEGIN)||this._myCardBox.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchCardFunc,this),this._myCardBox.hasEventListener(egret.TouchEvent.TOUCH_MOVE)||this._myCardBox.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMoveFunc,this),this.stage.hasEventListener(egret.TouchEvent.TOUCH_END)||this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onEndFunc,this)):(this.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginFunc,this),this._myCardBox.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchCardFunc,this),this._myCardBox.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMoveFunc,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEndFunc,this))},e.prototype.finishDizhuAnimate=function(){this.removeDiCard(),this.setMyCard(),this.setListener(!0)},e.prototype.cardOnTouch=function(t){var e=this._player.myPlayCards;t.onTouch?e.push(t):-1!==e.indexOf(t)&&e.splice(e.indexOf(t),1)},e.prototype.onBeginFunc=function(t){this._startX=t.stageX},e.prototype.onTouchCardFunc=function(t){var e=t.target;e.isSelect=!e.currentState},e.prototype.onMoveFunc=function(t){var e=t.target;this._move||(this._dir=t.stageX-this._startX,this._move=!0),this._nowDir=this._oldX-t.stageX,this._dir>0?t.stageX>this._oldX?e.isSelect=!e.currentState:e.isSelect=e.currentState:this._dir<0&&(t.stageX<this._oldX?e.isSelect=!e.currentState:e.isSelect=e.currentState),this._oldX=t.stageX},e.prototype.onEndFunc=function(t){this._move=!1;for(var e=!1,n=0;n<this._myCardBox.numChildren;n++){var a=this._myCardBox.getChildAt(n);a.isSelect&&(a.onTouch=!a.onTouch,this.cardOnTouch(a),a.isSelect=!1,e=!0),a.currentState=a.isSelect}e&&this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["play_card_snd_mp3"])},e.prototype.finishPlay=function(t){this._dizhuHead.source=RES.getRes("dizhu_head"),t.parent&&t.parent.removeChild(t)},e.prototype.setHeadImg=function(t,e,n){var a=this;this._dizhuHead=t;var i=AnimateManager.instance.createAnimate("magic",1,this,0,20,this.finishPlay,this);i.x=t.localToGlobal(-3,-25).x,i.y=t.localToGlobal(-3,-25).y,setTimeout(function(){a._dizhuHead.source=RES.getRes("dizhu_head")},1500),e.source=RES.getRes("man_head"),n.source=RES.getRes("man_head")},e.prototype.onPlayGame=function(t){var e=t.waitTime;this._currentRoleId=t.roleId,this._playTime=t.waitTime-2,e>20&&(e=20),0>e&&(e=0),this._currentTime_txt&&(this._currentTime_txt.text=e+"");var n=this._player.getSeatNoByRoleId(t.roleId);this._gameTimer.start(),this.showRect(n,!1,e);var a=t.roleId==this._player.roleId?!0:!1;this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{onMyTurn:a});var i;if(a&&1==t.type){if(this._player.curCards.type=-1,this._player.curCards.header=0,this.pass_btn.visible=!1,i=CardUtils.instance.calcCardType(this._player.cardList),0!=i&&6!=i&&14!=i){this._player.myPlayCards.splice(0,this._player.myPlayCards.length);for(var o=this._player.cardList.length,s=0;o>s;s++){var r=this._player.cardList[s];this._player.myPlayCards.push(r)}this.playCard()}}else if(a)if(CardUtils.instance.biggerThan(this._player.curCards.type,this._player.curCards.header,this._player.curCards.cards.length,this._player.cardList)){if(i=CardUtils.instance.calcCardType(this._player.cardList),0!=i&&(i==this._player.curCards.type||12==i||13==i)){this._player.myPlayCards.splice(0,this._player.myPlayCards.length);for(var o=this._player.cardList.length,s=0;o>s;s++){var r=this._player.cardList[s];this._player.myPlayCards.push(r)}this.playCard()}}else this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您没有牌大过上家",1500,-1,630]);this.setFinishFunc(n,0)},e.prototype.stopGameTimer=function(){this._gameTimer.stop(),this._playTime=-99,this._currentRoleId=null},e.prototype.onPassCard=function(t){this.showCards(t.SeatNo+1,!0)},e.prototype.playCardError=function(t){console.log("错误信息......")},e.prototype.onPlayCard=function(t){var e=this._player.getSeatNoByRoleId(t.roleId),n=CardUtils.instance.getCurCards(t.cardList);this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{curCards:n}),console.log("出的牌。。。",this._player.curCards),this._player.curCards.cards.length>0&&(this._startPlay||(this._startPlay=!0)),this.showCards(e,!1,n)},e.prototype.showCards=function(t,e,n){if(void 0===e&&(e=!1),void 0===n&&(n=null),t!=this._player.seatNo){!n&&(n=this._player.curCards);var a,i=n.cards.length,o=0;switch(t){case this._player.leftSeatNo:a="left";break;case this._player.rightSeatNo:a="right";break;case this._player.seatNo:a="my"}var s=this[a+"_card_box"];if(s.removeChildren(),e)return this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["pass_snd_mp3"]),void(this[a+"_pass"].visible=!0);this[a+"_pass"].visible=!1,s.visible=!0;var r;i>0&&this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["play_card_snd_mp3"]),CardUtils.instance.playCardSnd(a,n);var _=Math.min(i,this._horizontalNum)-1;o="left"==a?36:-(_*this._gap+ConfigData.SHOWCARDWIDTH);for(var h=0;i>h;h++)r=CardUtils.instance.getCardFromPool(n.cards[h],90,124),s.addChild(r),"my"!=a?(r.y=h<=this._horizontalNum?0:.4*r.height,r.x=h%(this._horizontalNum+1)*this._gap+o):(r.y=0,r.x=h*this._gap+o),h==i-1&&t==this._player.dizhuSeatNo&&(r.addChild(this._dizhuBmp_small),this._dizhuBmp_small.x=r.width-this._dizhuBmp_small.width);if(t!=this._player.seatNo){var l=t==this._player.rightSeatNo?this.right_num_txt:this.left_num_txt,c=t==this._player.rightSeatNo?"rightRed":"leftRed",d=parseInt(l.text)-n.cards.length;if(3>d&&!AnimateManager.instance.hasAnimate(c)){this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["fast_snd_mp3"]);var u=void 0;t==this._player.rightSeatNo?(u=AnimateManager.instance.createAnimate("redAlert",1,this,-1,3),u.x=1456,u.y=324):(u=AnimateManager.instance.createAnimate("redAlert",1,this,-1,3),u.x=418,u.y=324),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_ONCE,["left"+d+"_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_ONCE,["bibi_snd_mp3"])}l.text=""+d}}},e.prototype.setFinishFunc=function(t,e){void 0===e&&(e=0),this._finishFunc=null,t==this._player.seatNo&&(this._currentTime_txt=this.my_time_txt,0==e?this._player.curCards.type==CARD_TYPE.NO_CARDS?this._finishFunc=this.setMinCard:this._finishFunc=this.passCard:1==e?this._finishFunc=this.wantDizhu:2==e&&(this._finishFunc=this.jiabei))},e.prototype.showRect=function(t,e,n){void 0===e&&(e=!1),t==this._player.leftSeatNo?(this.left_clock.visible=!0,this._currentTime_txt=this.left_time_txt,this.right_clock.visible=!1,this.my_clock.visible=!1,this.play_btn.visible=!1,this.tip_btn.visible=!1,this.pass_btn.visible=!1,this.jiabei_btn.visible=!1,this.bujiabei_btn.visible=!1,this.left_card_box.visible=!1,this.left_pass.visible=!1):t==this._player.seatNo?(this.left_clock.visible=!1,this.right_clock.visible=!1,this.my_clock.visible=!0,this._currentTime_txt=this.my_time_txt,e||(this.pass_btn.visible=!0,this.play_btn.visible=!0,this.tip_btn.visible=!0),this.my_card_box.visible=!1,this.my_pass.visible=!1):t==this._player.rightSeatNo&&(this.left_clock.visible=!1,this.right_clock.visible=!0,this._currentTime_txt=this.right_time_txt,this.my_clock.visible=!1,this.play_btn.visible=!1,this.tip_btn.visible=!1,this.pass_btn.visible=!1,this.jiabei_btn.visible=!1,this.bujiabei_btn.visible=!1,this.right_card_box.visible=!1,this.right_pass.visible=!1)},e.prototype.setMinCard=function(){if(this._player.cardList.length>0){for(var t=0;t<this._player.myPlayCards.length;t++)this._player.myPlayCards[t].onTouch=!1;this._player.myPlayCards.splice(0,this._player.myPlayCards.length);var e=this._player.cardList[this._player.cardList.length-1];this._player.myPlayCards.push(e),this.playCard()}},e.prototype.playCard=function(){if(!CardUtils.instance.canPlay(this._player.curCards,this._player.myPlayCards))return this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您选择的牌不符合规则",500,-1,630]),void this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["forbid_snd_mp3"]);var t=this._player.myPlayCards;t.sort(function(t,e){return t.point-e.point});var e=CardUtils.instance.calcCardType(t),n=CardUtils.instance.calcHeadPoker(e,t),a=CardUtils.instance.transCardsToIndex(t),i=CardUtils.instance.transCardsToCardList(t);ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_PLAY_CARD,{cardList:i}),this._player.removeCards(),this._dizhuBmp.parent&&this._dizhuBmp.parent.removeChild(this._dizhuBmp),this.my_card_box.removeChildren(),this.my_card_box.visible=!0;var o;this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["play_card_snd_mp3"]);var s=new CurCards(e,n,a);CardUtils.instance.playCardSnd("my",s);for(var r=s.cards.length,_=ConfigData.stageWidth-ConfigData.LEFTGAP-ConfigData.CARDWIDTH,h=ConfigData.LEFTGAP+(_-this._gap*(r-1)-ConfigData.CARDWIDTH)/2,l=0;r>l;l++)o=CardUtils.instance.getCardFromPool(s.cards[l],90,124),this.my_card_box.addChild(o),o.y=0,o.x=h+l*this._gap,l==r-1&&this._player.isLandlord&&(o.addChild(this._dizhuBmp_small),this._dizhuBmp_small.x=o.width-this._dizhuBmp_small.width);this.my_clock.visible=!1,this.play_btn.visible=!1,this.tip_btn.visible=!1,this.pass_btn.visible=!1,this._finishFunc=null,this.setMyCard(),this._player.cardList.length<3&&this._player.cardList.length>0&&(this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["fast_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_ONCE,["left"+this._player.cardList.length+"_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_ONCE,["bibi_snd_mp3"])),this.stopGameTimer()},e.prototype.playCardSuccess=function(t){},e.prototype.passCard=function(){ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_PLAY_CARD);for(var t=this._player.myPlayCards.length,e=0;t>e;e++){var n=this._player.myPlayCards[e];n.onTouch&&(n.onTouch=!1,n.isSelect=!1,n.currentState=!1)}this._player.myPlayCards.splice(0,this._player.myPlayCards.length),t>0&&this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["selected_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["pass_snd_mp3"]),this.my_pass.visible=!0,this.my_clock.visible=!1,this.play_btn.visible=!1,this.tip_btn.visible=!1,this.pass_btn.visible=!1,this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_TIP),this.stopGameTimer()},e.prototype.tipCard=function(){var t=CardUtils.instance.getBiggerThanCard(this._player.curCards,this._player.cardList,null);if(!(this._player.curCards.type<0))if(t.length>0){var e=void 0,n=this._player.myPlayCards.length;for(e=0;n>e;e++){var a=this._player.myPlayCards[e];a.onTouch&&(a.onTouch=!1,a.isSelect=!1,a.currentState=!1)}for(this._player.myPlayCards.splice(0,this._player.myPlayCards.length),e=0;e<t.length;e++){var i=t[e];i.onTouch=!i.onTouch,this.cardOnTouch(i),i.isSelect=!1,i.currentState=i.isSelect}this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_SOUND,["play_card_snd_mp3"])}else this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您没有牌大过上家",1500,-1,630])},e.prototype.gameOver=function(t){var e=this;AnimateManager.instance.removeAnimate(),com.protobuff.data.RoleRoomModule,this.left_num_box.visible=!1,this.right_num_box.visible=!1,this.my_clock.visible=!1,this.left_clock.visible=!1,this.right_clock.visible=!1,this.gameOverData=t,this._startPlay=!1,this._finishFunc=null,this.setListener(!1),this.play_btn.visible=!1,this.tip_btn.visible=!1,this.pass_btn.visible=!1,this.left_pass.visible=!1,this.right_pass.visible=!1,this.my_pass.visible=!1;for(var n,a,i=t.roleList,o={},s=0;s<i.length;s++){var r=i[s];r.roleId==this._player.roleId&&(n=r),a=this._player.getSeatNoByRoleId(r.roleId),o[a]=CardUtils.instance.getIndexArr(r.cardList)}for(a in o)if(a=+a,a!=this._player.seatNo){var _=o[a],h=_.length,l=0,s=0,c=void 0;switch(a){case this._player.leftSeatNo:c="left";break;case this._player.rightSeatNo:c="right";break;case this._player.seatNo:c="my"}_.sort(function(t,e){return CardUtils.instance.getPoint(parseInt(e))-CardUtils.instance.getPoint(parseInt(t))});var d=Math.min(h,this._horizontalNum)-1;l="left"==c?36:-(d*this._gap+ConfigData.SHOWCARDWIDTH);var u=this[c+"_card_box"];for("my"!=c&&u.removeChildren(),this[c+"_pass"].visible=!1,u.visible=!0,s=0;h>s;s++){var C=void 0;C=CardUtils.instance.getCardFromPool(_[s],90,124),u.addChild(C),C.y=s<=this._horizontalNum?0:.4*C.height;var p=void 0;p=s%(this._horizontalNum+1)*this._gap+l,egret.Tween.get(C).to({x:p},50*s),s==h-1&&a==this._player.dizhuSeatNo&&(C.addChild(this._dizhuBmp_small),this._dizhuBmp_small.x=C.width-this._dizhuBmp_small.width)}}var m=3e3;1==t.isSingle&&(this.springBmp||(this.springBmp=new egret.Bitmap,this.springBmp.texture=RES.getRes("春天"),this.springBmp.x=(ConfigData.stageWidth-this.springBmp.width)/2,this.springBmp.y=215,this.addChild(this.springBmp)),this.springBmp.visible=!0,setTimeout(function(){e.springBmp.visible=!1},2e3),m=4e3),setTimeout(function(){var t=new Object,a=e._player.isLandlord?"地主 *2":"农民 *1";t.base="底分 "+e._player.baseNum,t.type=a,t.times="倍数 *"+e.gameOverData.Score,1==n.settleResult?t.overType="win":t.overType="lose",e._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_OVER,t),e._nowSeatNo=999,e._nowPlaySeatNo=999,e._scoreObj={1:0,2:0,3:0},e._player.clear(),e._player.clearRoom()},m)},e.prototype.destroy=function(){this.removeView(),this._channel=null,this.findTxt=null,this.play_btn=null,this.pass_btn=null,this.tip_btn=null,this.return_btn=null,this._player=null,this._myCardBox=null,this._dizhuCardBox=null,this.my_card_box=null,this.left_card_box=null,this.right_card_box=null,this._dizhuBmp&&this._dizhuBmp.texture&&this._dizhuBmp.texture.dispose(),this._dizhuBmp_small&&this._dizhuBmp_small.texture&&this._dizhuBmp_small.texture.dispose(),this._dizhuBmp_small=null,this._finishFunc=null,this.my_name_txt=null,this.left_name_txt=null,this.right_name_txt=null,this.snd_btn=null,this.music_btn=null,this.coin_bg&&this.coin_bg.texture&&this.coin_bg.texture.dispose(),this.coin_bg=null,this.talk_btn=null,this.talk_bg=null,this.talk_scroller=null,this.talk_group=null,this.left_talk=null,this.left_talk_txt=null,this.right_talk=null,this.right_talk_txt=null,this.my_talk=null,this.my_talk_txt=null,this.call_txt=null,this._scoreObj=null,this.my_head_img&&this.my_head_img.texture&&this.my_head_img.texture.dispose(),this.my_head_img=null,this.right_head_img&&this.right_head_img.texture&&this.right_head_img.texture.dispose(),this.right_head_img=null,this.left_head_img&&this.left_head_img.texture&&this.left_head_img.texture.dispose(),this.left_head_img=null,this.left_num_txt=null,this.right_num_txt=null,this.left_num_box=null,this.right_num_box=null,this.left_num_box=null,this._dizhuHead&&this._dizhuHead.texture&&this._dizhuHead.texture.dispose(),this._dizhuHead=null,this.left_pass=null,this.right_pass=null,this.my_pass=null,this.left_time_txt=null,this.right_time_txt=null,this.my_time_txt=null,this._currentTime_txt=null,this.gameOverData=null,this.springBmp&&this.springBmp.texture&&this.springBmp.texture.dispose(),this.springBmp=null},e}(eui.Component);__reflect(Battle.prototype,"Battle",["eui.UIComponent","egret.DisplayObject"]);
var Card=function(t){function e(e){void 0===e&&(e=0);var n=t.call(this)||this;n._isSelect=!1,n.currentState=!1,n._pokeBmp=new egret.Bitmap,n._selectBg=new egret.Shape,n.setWidth(ConfigData.CARDWIDTH),n.setHeight(ConfigData.CARDHEIGHT);var a=n._selectBg.graphics;return a.beginFill(0,.3),a.drawRoundRect(0,0,n.width,n.height,25,25),n.addChild(n._pokeBmp),n.addChild(n._selectBg),n._selectBg.visible=!1,n.index=e,n.touchEnabled=!0,n}return __extends(e,t),e.prototype.setWidth=function(t){this._pokeBmp.width=t,this.width=this._pokeBmp.width,this._selectBg.width=this.width},e.prototype.setHeight=function(t){this._pokeBmp.height=t,this.height=this._pokeBmp.height,this._selectBg.height=this.height},Object.defineProperty(e.prototype,"source",{set:function(t){this._pokeBmp.texture=RES.getRes(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},set:function(t){this._index=t,0==this._index?this._pokeBmp.texture=RES.getRes("backPoker"):(this._pokeBmp.texture=RES.getRes(t+""),this.point=CardUtils.instance.getPoint(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTouch",{get:function(){return this._onTouch},set:function(t){this._onTouch=t,t?this.y-=15:this.y+=15},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSelect",{get:function(){return this._isSelect},set:function(t){this._selectBg.visible=t,this._isSelect=t},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._pokeBmp&&this._pokeBmp.texture&&this._pokeBmp.texture.dispose(),this._pokeBmp=null,this._selectBg=null},e}(egret.Sprite);__reflect(Card.prototype,"Card");var Cash=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n._channel.addFuncToDataProxy(ConstData.PLAYER_PROXY,ConstData.PLAYER_BALANCE,n.setBalance,n),n.urlloader=new egret.URLLoader,n.urlreq=new egret.URLRequest,n.urlloader.addEventListener(egret.Event.COMPLETE,n.onComplete,n),n}return __extends(e,t),e.prototype.init=function(){this.cash_txt&&(this.cash_txt.text="1300")},e.prototype.setBalance=function(t){this._ekt=parseFloat(t),this.tip_txt.text="最多可提现EKT  "+this._ekt,this.cash_txt.text=this._ekt+""},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){switch(e){case"close_btn":this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.CASH_VIEW]);break;case"cash_btn":this.onCashFunc();break;case"half_btn":case"twice_btn":case"max_btn":this.fastInput(t)}},this)},e.prototype.fastInput=function(t){var e=t.target,n=parseFloat(this.cash_txt.text);n&&(e==this.half_btn?n=(n/2).toFixed(4):e==this.twice_btn?n=(2*n).toFixed(4):e==this.max_btn&&(n=this._ekt),n=parseFloat(n),this.cash_txt.text=n+"")},e.prototype.checkInGame=function(){this.urlreq.requestHeaders=[new egret.URLRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8")],this.urlreq.url="/dapp/ddz/api/getStatus?address="+Player.instance.addr,this.urlloader.load(this.urlreq),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_WAIT,"请稍等...")},e.prototype.onComplete=function(t){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT);var e=JSON.parse(t.target.data);1!=e.result?this.onCashFunc():1==e.result&&this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您有未结束的游戏，无法提现"])},e.prototype.onCashFunc=function(){var t=this.cash_txt.text,e=/^[0-9]{1,9}([.]{1}[0-9]{1,4})?$/;e.test(t)&&0!=parseFloat(t)?parseFloat(t)>this._ekt&&this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["提现金额大于所剩金额"]):this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请输入正确的金额"])},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.cash_txt.text="1300",this.cash_txt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showKeyBoard,this),this.key_board.addEventListener(egret.TouchEvent.TOUCH_TAP,this.inputNum,this),this.reset_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.cash_txt.text=""},this)},e.prototype.showKeyBoard=function(){this.key_board.visible=!this.key_board.visible},e.prototype.inputNum=function(t){var e=this.cash_txt.text;return e.length>8?void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您输入的金额过大"]):(e+=t.target.name,void(this.cash_txt.text=e))},e.prototype.removeView=function(){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT)},e.prototype.destroy=function(){this._channel=null,this.urlloader=null,this.tip_txt=null,this.half_btn=null,this.twice_btn=null,this.max_btn=null,this.key_board=null,this.reset_btn=null,this.urlreq=null},e}(eui.Component);__reflect(Cash.prototype,"Cash",["eui.UIComponent","egret.DisplayObject"]);var GameRule=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.init=function(){document.bgColor="#0d1b51"},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){switch(e){case"return_btn":this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.GAME_RULE_VIEW])}},this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e="\n斗地主是一种三人游戏，对局开始时通过叫抢地主决定阵营，阵营双方对战，先出完牌的一方获胜。\n\n";e+="地主拥有首出权，玩家按照逆时针方向跟牌，每位玩家可以选择用更大的牌组跟牌或者不跟牌。\n",e+="合法牌型（王炸＞炸弹＞其他牌型）\n",e+="王炸: 两张王    炸弹: 四张同样数字的牌\n",e+="单牌: 一张单独的牌    对牌: 两张相同数字的牌    三张: 三张相同数字的牌\n",e+="三带一: 三张相同数字的牌带一张任意不同数字的牌\n",e+="三带二: 三张相同数字的牌带两张相同数字的牌\n",e+="顺子: 五张（或以上）点数连续的牌（2和双王除外）\n",e+="连对: 三对（或以上）的连续对牌（2和双王除外）\n",e+="飞机: 两个（或以上）的连续三张（2和双王除外）\n",e+="飞机带翅膀: 飞机+同数量的单牌或飞机+同数量的对牌\n",e+="四带二: 四张+两张单牌 或 四张+两个对牌（四带二不是炸弹）\n",this.rule_txt.text=e},e.prototype.removeView=function(){document.bgColor="#0d1b51"},e.prototype.destroy=function(){this._channel=null,this.rule_txt=null},e}(eui.Component);__reflect(GameRule.prototype,"GameRule",["eui.UIComponent","egret.DisplayObject"]);var Ground=function(t){function e(e){var n=t.call(this)||this;return n.ekt=0,n._isGame=!1,n._tapTime=0,n._tapNum=0,n._channel=e,n}return __extends(e,t),e.prototype.init=function(){document.bgColor="#0d1b51",this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["ground_snd_mp3"]),this.addSpark(this.primary),this.addSpark(this.middle),this.addSpark(this.high),this.sndBtn&&(this.sndBtn.selected=this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_GET_PLAY_SND)),this.musicBtn&&(this.musicBtn.selected=this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_GET_PLAY_MUSIC))},e.prototype.setEktTxt=function(t){if(this.ekt=t,this.ekt_txt){var e=parseInt(t.toString().split(".")[0]),n=void 0;e>1e4?(n=(e/1e4).toFixed(2)+"万",this.ekt_txt.text=n):this.ekt_txt.text=parseFloat(t)+""}},e.prototype.checkInGame=function(t){var e=this;this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._finishFuc=t,this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_WAIT,"正在进入游戏..."),setTimeout(function(){e._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT)},1500)},e.prototype.onComplete=function(t){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT);var e=JSON.parse(t.target.data);1==e.result?(this._isGame=!0,this._finishFuc&&this._finishFuc(),this._finishFuc=null):this._isGame=!1},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n);n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){var n=this;switch(e){case"primary":this.checkInGame(function(){n.selectBattle(2,48,37)});break;case"middle":this.checkInGame(function(){n.selectBattle(10,240)});break;case"high":this.checkInGame(function(){n.selectBattle(50,1200,780)});break;case"return_btn":this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.HALL_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.GROUND_VIEW]);break;case"recharge_btn":this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.RECHARGE_VIEW,0,0,ConstData.UI_LAYER]);break;case"cash_btn":this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.CASH_VIEW,0,0,ConstData.UI_LAYER]);break;case"snd_btn":this.sndBtn.selected=!this.sndBtn.selected,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_IS_PLAY_SND,this.sndBtn.selected);break;case"music_btn":this.musicBtn.selected=!this.musicBtn.selected,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_IS_PLAY_MUSIC,this.musicBtn.selected);break;case"fast_play_btn":this.enterGame_Now(2,48)}},this)},e.prototype.enterGame_Now=function(t,e){this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{minEkt:e}),this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{baseNum:t}),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.BATTLE_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.GROUND_VIEW]),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_MATCH_PLAYERS)},e.prototype.selectBattle=function(t,e,n){if(void 0===n&&(n=-1),this.ekt<e&&!ConfigData.DEBUG&&!this._isGame)return this._tapNum>3?void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请检查您的网络是否断开",500]):void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您的金额不足",500,n]);var a=new Date,i=a.getTime();return i-this._tapTime<1e3?void(this._tapTime=i):(this._tapNum++,this._tapNum>3&&this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请检查您的网络是否断开",500]),this._tapTime=i,void this.enterGame(t,e))},e.prototype.enterGame=function(t,e){this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{baseNum:t}),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.BATTLE_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.GROUND_VIEW]),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_MATCH_PLAYERS)},e.prototype.addSpark=function(t){if(t){var e=t.getChildByName("spark");if(!e){var n=new egret.Sprite;e=new egret.Bitmap(RES.getRes("spark_png")),n.width=e.width,n.height=e.height,n.graphics.beginFill(0),n.graphics.drawRoundRect(20,37,284,406,20,20),n.graphics.endFill(),t.addChild(n),e.mask=n,e.name="spark",e.alpha=.2,e.blendMode=egret.BlendMode.ADD,t.addChild(e)}var a=e.width,i=e.height,o=Math.atan2(a,i),s=Math.sin(o)*Math.cos(o)*i,r=Math.sin(o)*Math.sin(o)*i;e.x=-s,e.y=r,egret.Tween.get(e,{loop:!0}).to({x:s+50,y:-r-50},1350).wait(2e3).to({x:-s,y:r},0)}},e.prototype.removeSparkTween=function(t){var e=t.getChildByName("spark");e&&egret.Tween.removeTweens(e)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.tip_btn.touchEnabled=!0,this.tip_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tipFunc,this)},e.prototype.tipFunc=function(){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.GAME_RULE_VIEW,0,0,ConstData.UI_LAYER])},e.prototype.removeView=function(){this._tapNum=0},e.prototype.destroy=function(){this.removeView(),this._channel=null,this.ekt_txt=null,this.primary=null,this.middle=null,this.high=null,this.return_btn=null,this.sndBtn=null,this.musicBtn=null},e}(eui.Component);__reflect(Ground.prototype,"Ground",["eui.UIComponent","egret.DisplayObject"]);var Hall=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.init=function(){this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["dating_snd_mp3"])},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addListener(),GameTools.addGrayFilter([this.buyu_btn]),this.gold_txt.text="0"},e.prototype.addListener=function(){this.ddz_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDdzFunc,this),this.niuniu_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onNiuniuFunc,this),this.bairen_niuniu_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBairenNiuniuFunc,this)},e.prototype.onBuyuFunc=function(){},e.prototype.onDdzFunc=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=new NiuniuLoadingView,this.addChild(t),[4,RES.loadGroup("ddz",0,t)];case 1:return e.sent(),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.GROUND_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.HALL_VIEW]),[2]}})})},e.prototype.onNiuniuFunc=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=new NiuniuLoadingView,this.addChild(t),[4,RES.loadGroup("niuniu",0,t)];case 1:return e.sent(),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.NIUNIU_GROUND_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.HALL_VIEW]),[2]}})})},e.prototype.onBairenNiuniuFunc=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=new NiuniuLoadingView,this.addChild(t),[4,RES.loadGroup("barrenniuniu",0,t)];case 1:return e.sent(),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.BAIREN_NIUNIU_GROUND_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.HALL_VIEW]),[2]}})})},e.prototype.removeView=function(){},e.prototype.destroy=function(){this.removeView(),this._channel=null,this.ddz_btn=null,this.niuniu_btn=null,this.bairen_niuniu_btn=null,this.buyu_btn=null,this.gold_txt=null},e}(eui.Component);__reflect(Hall.prototype,"Hall",["eui.UIComponent","egret.DisplayObject"]);var LoadingView=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=new egret.Bitmap(RES.getRes("load_bg"));this.addChild(t),this._ddzFontBmp=new egret.Bitmap(RES.getRes("logo")),this._ddzFontBmp.x=55,this._ddzFontBmp.y=31,this.addChild(this._ddzFontBmp),this._progressBg=new egret.Bitmap(RES.getRes("progress_bg")),this._progressBar=new eui.Image(RES.getRes("progress_bar")),this._progressBg.x=(ConfigData.stageWidth-this._progressBg.width)/2,this._progressBg.y=931,this.addChild(this._progressBg),this._progressBar.x=this._progressBg.x+5,this._progressBar.y=this._progressBg.y+5;var e=new egret.Rectangle(17,6,820,48);this._progressBar.scale9Grid=e,this._progressBar.width=100,this.addChild(this._progressBar),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.textField.verticalAlign="middle",this.textField.textColor=16777215,this.textField.x=(ConfigData.stageWidth-this.textField.width)/2,this.textField.y=this._progressBg.y-10},e.prototype.onProgress=function(t,e){this.textField.text="正在加载 ..."+t+"/"+e,this._progressBar.width=100+t/e*(this._progressBg.width-100),t==e&&(this.removeChild(this._progressBg),this.removeChild(this._progressBar),egret.Tween.removeTweens(this._ddzFontBmp),this.showLoginBtn())},e.prototype.showLoginBtn=function(){this.removeChild(this.textField);var t=new egret.Bitmap(RES.getRes("youke_btn"));t.x=156,t.y=850,this.addChild(t),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLogin,this);var e=new egret.Bitmap(RES.getRes("weixin_btn"));e.x=719,e.y=850,this.addChild(e);var n=new egret.Bitmap(RES.getRes("zhanghao_btn"));n.x=1281,n.y=850,this.addChild(n)},e.prototype.onLogin=function(){this.stage.addChild(Game.instance),this.parent.removeChild(this),this.destroy()},e.prototype.destroy=function(){this.textField=null,this._ddzFontBmp=null,this._progressBar=null},e}(egret.Sprite);__reflect(LoadingView.prototype,"LoadingView",["RES.PromiseTaskReporter"]);var Login=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.childrenCreated=function(){this.login_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginFunc,this)},e.prototype.onLoginFunc=function(){this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_LOGIN)},e.prototype.destroy=function(){t.prototype.removeChildren.call(this),this._channel=null,this.login_btn.texture.dispose(),this.login_btn=null},e}(eui.Component);__reflect(Login.prototype,"Login",["eui.UIComponent","egret.DisplayObject"]);var Lose=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.init=function(){document.bgColor="#0d1b51",this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["fail_snd_mp3",1])},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.leave_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leave,this),this.continue_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this["continue"],this)},e.prototype.show=function(t){new egret.GlowFilter(5962,.8,4,4)},e.prototype.leave=function(){this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_ALL_VIEW),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_CLEAR),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.GROUND_VIEW,0,0,ConstData.UI_LAYER]),ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_GAME_PREPARE,{status:0})},e.prototype["continue"]=function(){this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.LOSE_VIEW]),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_CLEAR),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.BATTLE_VIEW,0,0,ConstData.UI_LAYER]),ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_GAME_PREPARE,{status:1})},e.prototype.destroy=function(){this.leave_btn=null,this.continue_btn=null,this._channel=null},e}(eui.Component);__reflect(Lose.prototype,"Lose",["eui.UIComponent","egret.DisplayObject"]);var MatchEnd=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){switch(e){case"continue_btn":this.continueMath();break;case"leave_btn":this.leaveMatch()}},this)},e.prototype.continueMath=function(){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.MATCH_END_VIEW]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["battle_snd_mp3"]),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_MATCH_PLAYERS)},e.prototype.leaveMatch=function(){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.MATCH_END_VIEW]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.BATTLE_VIEW]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.GROUND_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.NET_CONTROLLER,ConstData.NET_CLOSE)},e.prototype.destroy=function(){this._channel=null},e}(eui.Component);__reflect(MatchEnd.prototype,"MatchEnd",["eui.UIComponent","egret.DisplayObject"]);var Pregame=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.init=function(){},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){switch(e){case"return_game_btn":this.returnGame()}},this)},e.prototype.returnGame=function(){},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(eui.Component);__reflect(Pregame.prototype,"Pregame",["eui.UIComponent","egret.DisplayObject"]);var Recharge=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n._channel.addFuncToDataProxy(ConstData.PLAYER_PROXY,ConstData.PLAYER_EKT,n.setLeftEkt,n),n}return __extends(e,t),e.prototype.init=function(){this.recharge_txt&&(this.recharge_txt.text="1300")},e.prototype.setLeftEkt=function(t){this._ekt=t,this.tip_txt.text="EKT可用余额  "+t,this.recharge_txt.text=""+(t>1300?"1300":t)},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){switch(e){case"close_btn":console.log(111111111),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.RECHARGE_VIEW]);break;case"recharge_btn":this.onRechargeFunc();break;case"half_btn":case"twice_btn":case"max_btn":this.fastInput(t)}},this)},e.prototype.fastInput=function(t){var e=t.target,n=parseFloat(this.recharge_txt.text);n&&(e==this.half_btn?n=(n/2).toFixed(0):e==this.twice_btn?n=(2*n).toFixed(0):e==this.max_btn&&(n=parseInt(this._ekt)),n=parseFloat(n),this.recharge_txt.text=n+"")},e.prototype.onRechargeFunc=function(){var t=this.recharge_txt.text,e=/^[0-9]{1,9}([.]{1}[0-9]{1,4})?$/;e.test(t)&&0!=parseFloat(t)?parseFloat(t)>this._ekt&&this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["充值金额大于所剩金额"]):this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请输入正确的金额"])},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.recharge_txt.text="1300",this.recharge_txt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showKeyBoard,this),this.key_board.addEventListener(egret.TouchEvent.TOUCH_TAP,this.inputNum,this),this.reset_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.recharge_txt.text=""},this)},e.prototype.showKeyBoard=function(){this.key_board.visible=!this.key_board.visible},e.prototype.inputNum=function(t){var e=this.recharge_txt.text;return e.length>8?void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您输入的金额过大"]):(e+=t.target.name,void(this.recharge_txt.text=e))},e.prototype.removeView=function(){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT)},e.prototype.destroy=function(){this._channel=null,this.recharge_txt=null,this.tip_txt=null,this.half_btn=null,this.twice_btn=null,this.max_btn=null,this.key_board=null,this.reset_btn=null},e}(eui.Component);__reflect(Recharge.prototype,"Recharge",["eui.UIComponent","egret.DisplayObject"]);var RecordView=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.init=function(){},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){},this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(eui.Component);__reflect(RecordView.prototype,"RecordView",["eui.UIComponent","egret.DisplayObject"]);var Room=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.init=function(){},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){},this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(eui.Component);__reflect(Room.prototype,"Room",["eui.UIComponent","egret.DisplayObject"]);var TipView=function(t){function e(e){var n=t.call(this,e)||this;return n._tipTxt=new egret.TextField,n._tipTxt.bold=!0,n._tipTxt.size=38,n._tipTxt.textColor=16720418,n.addChild(n._tipTxt),n.width=1e3,n.height=57,n._tipTxt.width=n.width,n._tipTxt.height=n.height,n._tipTxt.textAlign="center",n._tipTxt.verticalAlign="middle",n}return __extends(e,t),e.prototype.addTip=function(t){void 0===t&&(t=["",800,-1,-1]);var e=t[0],n=t[1]?t[1]:500,a=t[2]?t[2]:-1,i=t[3]?t[3]:-1;this._tipTxt.text=e,-1==a?this.x=(ConfigData.stageWidth-this._tipTxt.width)/2:this.x=a,-1==i?this.y=(ConfigData.stageHeight-this._tipTxt.height)/2:this.y=i,egret.Tween.removeTweens(this),egret.Tween.get(this).to({alpha:1},n).wait(300).to({alpha:.3},n).call(this.removeTip,this)},e.prototype.removeTip=function(){this.parent&&this.parent.removeChild(this)},e}(BaseView);__reflect(TipView.prototype,"TipView");var WaitView=function(t){function e(e){var n=t.call(this,e)||this;return n.isJ=!0,n.viewName=ConstData.WAIT_VIEW,n._mask=new egret.Sprite,n._mask.graphics.beginFill(0,0),n.touchEnabled=!0,n._mask.graphics.drawRect(120,0,1090,ConfigData.stageHeight),n._mask.graphics.endFill(),n.addChild(n._mask),n._tipTxt=new egret.TextField,n._tipTxt.size=40,n._tipTxt.bold=!0,n._tipTxt.width=ConfigData.stageWidth,n._tipTxt.height=50,n._tipTxt.textColor=16776960,n._tipTxt.textAlign="center",n._tipTxt.x=(ConfigData.stageWidth-n._tipTxt.width)/2,n._tipTxt.y=(ConfigData.stageHeight-n._tipTxt.height)/2,n.addChild(n._tipTxt),n}return __extends(e,t),e.prototype.addWait=function(t){this._tipTxt.text=t},e.prototype.removeWait=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.removeChild(this._tipTxt),this._tipTxt=null},e}(BaseView);__reflect(WaitView.prototype,"WaitView");var Win=function(t){function e(e){var n=t.call(this)||this;return n._channel=e,n}return __extends(e,t),e.prototype.init=function(){document.bgColor="#0d1b51",this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["win_snd_mp3",1])},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.leave_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leave,this),this.continue_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this["continue"],this)},e.prototype.show=function(t){new egret.GlowFilter(5962,.8,4,4)},e.prototype.leave=function(){this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_ALL_VIEW),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_CLEAR),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.GROUND_VIEW,0,0,ConstData.UI_LAYER]),ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_GAME_PREPARE,{status:0})},e.prototype["continue"]=function(){this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_CLEAR),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.WIN_VIEW]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.BATTLE_VIEW,0,0,ConstData.UI_LAYER]),ProtoRegister.Ins.setMessage(NetCommands.MSG_TYPE_OF_GAME_PREPARE,{status:1})},e.prototype.destroy=function(){this.leave_btn=null,this.continue_btn=null,this._channel=null},e}(eui.Component);__reflect(Win.prototype,"Win",["eui.UIComponent","egret.DisplayObject"]);var BairenCardGroup=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.reset=function(){for(var t=0;5>t;t++){var e=this["card_"+t];e.visible=!0,e.source=RES.getRes("niuniu_card_json.card_back")}this.result_state.visible=!1},e.prototype.showCard=function(t){for(var e=0;e<t.cards.length;e++){var n=this["card_"+e];n.visible=!0,n.source=RES.getRes(t.cards[e]+"")}},e.prototype.setResultState=function(t){this.result_state.visible=!0,this.result_state.source=RES.getRes("niuniukaiju_json.nn_"+t)},e}(eui.Component);__reflect(BairenCardGroup.prototype,"BairenCardGroup",["eui.UIComponent","egret.DisplayObject"]);var BairenNiuniuBattle=function(t){function e(e){var n=t.call(this)||this;return n._waitCount=0,n._isSendOver=!1,n.seatObj={},n.zhuangJiaScoreObj={},n.currentPhase=0,n._channel=e,n._player=Player.instance,n._timer=new egret.Timer(1e3),n}return __extends(e,t),e.prototype.init=function(){this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["niuniubattle_snd_mp3"]);this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_GET_LAYER,ConstData.UI_LAYER)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addListener(),this.currentTime_txt.text="",this.currentTimeType_txt.text="",this.doorGroup_1.doorId=1,this.doorGroup_1.touchEnabled=!0,this.doorGroup_1.touchChildren=!1,this.doorGroup_2.doorId=2,this.doorGroup_2.touchEnabled=!0,this.doorGroup_2.touchChildren=!1,this.doorGroup_3.doorId=3,this.doorGroup_3.touchEnabled=!0,this.doorGroup_3.touchChildren=!1,this.doorGroup_4.doorId=4,this.doorGroup_4.touchEnabled=!0,this.doorGroup_4.touchChildren=!1},e.prototype.addListener=function(){this.coin_1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_10.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_50.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_100.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_500.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_1000.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.doorGroup_1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectDoor,this),this.doorGroup_2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectDoor,this),this.doorGroup_3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectDoor,this),this.doorGroup_4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectDoor,this),this.shangZhuang_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shangZhuangFunc,this),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onStartGroudTimer.bind(this),this),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onNextGroudTimer.bind(this),this)},e.prototype.selectDoor=function(t,e){var n=t.target;this.currentDoor!=n&&(this.currentDoor&&this.currentDoor.selected(),n.selected(),this.currentDoor=n)},e.prototype.removeListener=function(){this.coin_1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_10.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_50.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_100.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_500.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.coin_1000.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.doorGroup_1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.selectDoor,this),this.doorGroup_2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.selectDoor,this),this.doorGroup_3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.selectDoor,this),this.doorGroup_4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.selectDoor,this),this.shangZhuang_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.shangZhuangFunc,this)},e.prototype.shangZhuangFunc=function(t){if(!this.currentCoin)return void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请选择底注，上庄底注需大于200"]);
var e=+this.currentCoin.name;if(200>e)return void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["上庄底注需大于200"]);var n={crit:e};ProtoRegister.Ins.setMessage(NetCommands.BAI_NIUNIU_REQUEST_GRAB,n);this.shangZhuang_btn.visible=!1},e.prototype.broadXiaZhu=function(t){var e=this;this.currentPhase=1,this._waitCount=t.waitTime,this.currentTimeType_txt.visible=!0,this.currentTimeType_txt.text="下注倒计时",this.currentTime_txt.text=this._waitCount+"s",this.currentTime_txt.visible=!0,this.xiaZhuLogo.visible=!0,egret.Tween.get(this.xiaZhuLogo).to({alpha:1},800).wait(300).to({alpha:.3},800).call(function(){e.xiaZhuLogo.visible=!1},this)},e.prototype.xiaZhufunc=function(t){var e=t.target,n=+e.name;if(e.scaleX=e.scaleY=1.2,this.currentCoin&&this.currentCoin!=e&&(this.currentCoin.scaleX=this.currentCoin.scaleY=1),this.currentCoin=e,this._player.isLand)return void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您是庄家，无法下注"]);if(1==this.currentPhase){if(!this.currentDoor)return void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请先选择要在哪一门下注"]);var a={index:this.currentDoor.doorId,crit:n};ProtoRegister.Ins.setMessage(NetCommands.BAI_NIUNIU_ROLE_XIAZHU,a);this.currentDoor.addCoin(n)}},e.prototype.xiaZhu=function(t){if(this._player.roleId!=t.roleId){var e=this["doorGroup_"+t.index];e.addCoin(t.crit)}},e.prototype.matchPlayers=function(){var t={type:2};ProtoRegister.Ins.setMessage(NetCommands.BAI_NIUNIU_MATCH,t)},e.prototype.roomRoleChange=function(t){this._waitCount=t.waittime,this.cardGroup.visible=!0,this.currentTimeType_txt.text="开局倒计时",this.currentTime_txt.text=this._waitCount+"s",this._timer.start(),t.landId&&(this.zhuangjiaGroup.visible=!0),this.shangZhuang_btn.visible=!(t.landList.indexOf(this._player.roleId)>=0)},e.prototype.setCard=function(t,e){var n=this;void 0===t&&(t=0),2!=this.currentPhase&&(this.biPaiLogo.visible=!0,this.currentPhase=2,egret.Tween.get(this.biPaiLogo).to({alpha:1},800).wait(300).to({alpha:.3},800).call(function(){n.biPaiLogo.visible=!1},this)),this.setCardTo(0),setTimeout(this.setCardTo.bind(this,1),1200),setTimeout(this.setCardTo.bind(this,2),2400),setTimeout(this.setCardTo.bind(this,3),3600),setTimeout(this.setCardTo.bind(this,4),4800),setTimeout(this.jieSuan.bind(this,e),6e3)},e.prototype.setCardTo=function(t){var e=this;void 0===t&&(t=0);var n,a=new egret.Point(this.cardGroup.x,this.cardGroup.y);if(0==t)n=this.zhuangJiaCardGroup.localToGlobal(this.zhuangJiaCardGroup.x,this.zhuangJiaCardGroup.y),EffectManager.instance.fromToEffect(egret.MainContext.instance.stage,a,n,5,500,"niuniu_card_json.card_back",60,function(){e.zhuangJiaCardGroup.visible=!0},.5);else if(this["doorGroup_"+t]){var i=this["doorGroup_"+t];n=i.localToGlobal(i.cardGroup.x,i.cardGroup.y),EffectManager.instance.fromToEffect(egret.MainContext.instance.stage,a,n,5,500,"niuniu_card_json.card_back",60,function(){i.cardGroup.visible=!0},.5)}},e.prototype.jieSuan=function(t){var e,n=t.cardMap,a=t.cardType;for(var i in n){if("0"==i)e=this.zhuangJiaCardGroup;else{var o=this["doorGroup_"+i];e=o.cardGroup}e.showCard(n[i]);var s=this.getCardType(a[i]);e.setResultState(s)}this.nextRound(),this.currentPhase=0},e.prototype.getCardType=function(t){var e="",n=t;switch(n){case 0:e="mn";break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:e="n0"+n;break;case 10:e="n00";break;case 11:e="n4hn";break;case 12:e="n5hn"}return e},e.prototype.onStartGroudTimer=function(){this._waitCount<=0||(this.currentTime_txt.text=this._waitCount+"s",this._waitCount--)},e.prototype.nextRound=function(){var t={status:1};ProtoRegister.Ins.setMessage(NetCommands.BAI_NIUNIU_PREPARE,t);this._count=0},e.prototype.onNextGroudTimer=function(){if(this._count++,5==this._count){this.zhuangJiaCardGroup.visible=!1,this.zhuangJiaCardGroup.reset();for(var t=1;4>=t;t++){var e=this["doorGroup_"+t];e.clear()}}},e.prototype.shangZhuang=function(t){},e.prototype.grabSuccess=function(t){this._player.landId=t.landId,this.zhuangjiaGroup.visible=!0},e.prototype.onScoreChange=function(t){},e.prototype.closeMatchTimer=function(){},e.prototype.invaild=function(){},e.prototype.returnGround=function(){},e.prototype.clear=function(){},e.prototype.reconGame=function(t){},e}(eui.Component);__reflect(BairenNiuniuBattle.prototype,"BairenNiuniuBattle",["eui.UIComponent","egret.DisplayObject"]);var BairenNiuniuGround=function(t){function e(e){var n=t.call(this)||this;return n.ekt=0,n._isGame=!1,n._tapTime=0,n._tapNum=0,n._channel=e,n}return __extends(e,t),e.prototype.init=function(){document.bgColor="#0d1b51",this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["niuniu_ground_snd_mp3"]),this.sndBtn&&(this.sndBtn.selected=this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_GET_PLAY_SND)),this.musicBtn&&(this.musicBtn.selected=this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_GET_PLAY_MUSIC))},e.prototype.setEktTxt=function(t){if(this.ekt=t,this.ekt_txt){var e=parseInt(t.toString().split(".")[0]),n=void 0;e>1e4?(n=(e/1e4).toFixed(2)+"万",this.ekt_txt.text=n):this.ekt_txt.text=parseFloat(t)+""}},e.prototype.checkInGame=function(t){var e=this;this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._finishFuc=t,this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_WAIT,"正在进入游戏..."),setTimeout(function(){e._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT)},1500)},e.prototype.onComplete=function(t){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT);var e=JSON.parse(t.target.data);1==e.result?(this._isGame=!0,this._finishFuc&&this._finishFuc(),this._finishFuc=null):this._isGame=!1},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n);n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){var n=this;switch(e){case"primary":this.enterGame_Now(2,48);break;case"middle":this.checkInGame(function(){n.selectBattle(10,240)});break;case"high":this.enterGame_Now(2,48);break;case"return_btn":this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.HALL_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.GROUND_VIEW]);break;case"recharge_btn":this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.RECHARGE_VIEW,0,0,ConstData.UI_LAYER]);break;case"cash_btn":this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.CASH_VIEW,0,0,ConstData.UI_LAYER]);break;case"snd_btn":this.sndBtn.selected=!this.sndBtn.selected,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_IS_PLAY_SND,this.sndBtn.selected);break;case"music_btn":this.musicBtn.selected=!this.musicBtn.selected,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_IS_PLAY_MUSIC,this.musicBtn.selected);break;case"fast_play_btn":this.enterGame_Now(2,48)}},this)},e.prototype.enterGame_Now=function(t,e){this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{baseNum:t}),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.BAIREN_NIUNIU_BATTLE_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.BAIREN_NIUNIU_GROUND_VIEW]),this._channel.postCommand(ConstData.BAI_NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_BAI_NIU_MATCH_PLAYERS)},e.prototype.selectBattle=function(t,e,n){if(void 0===n&&(n=-1),this.ekt<e&&!ConfigData.DEBUG&&!this._isGame)return this._tapNum>3?void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请检查您的网络是否断开",500]):void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您的金额不足",500,n]);var a=new Date,i=a.getTime();return i-this._tapTime<1e3?void(this._tapTime=i):(this._tapNum++,this._tapNum>3&&this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请检查您的网络是否断开",500]),this._tapTime=i,void this.enterGame(t,e))},e.prototype.enterGame=function(t,e){this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{baseNum:t}),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.NIUNIU_BATTLE_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.NIUNIU_GROUND_VIEW]),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_NIU_MATCH_PLAYERS)},e.prototype.addSpark=function(t){if(t){var e=t.getChildByName("spark");if(!e){var n=new egret.Sprite;e=new egret.Bitmap(RES.getRes("spark_png")),n.width=e.width,n.height=e.height,n.graphics.beginFill(0),n.graphics.drawRoundRect(20,37,284,406,20,20),n.graphics.endFill(),t.addChild(n),e.mask=n,e.name="spark",e.alpha=.2,e.blendMode=egret.BlendMode.ADD,t.addChild(e)}var a=e.width,i=e.height,o=Math.atan2(a,i),s=Math.sin(o)*Math.cos(o)*i,r=Math.sin(o)*Math.sin(o)*i;e.x=-s,e.y=r,egret.Tween.get(e,{loop:!0}).to({x:s+50,y:-r-50},1350).wait(2e3).to({x:-s,y:r},0)}},e.prototype.removeSparkTween=function(t){var e=t.getChildByName("spark");e&&egret.Tween.removeTweens(e)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.tipFunc=function(){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.GAME_RULE_VIEW,0,0,ConstData.UI_LAYER])},e.prototype.removeView=function(){this._tapNum=0},e.prototype.destroy=function(){this.removeView(),this._channel=null,this.ekt_txt=null,this.primary=null,this.high=null,this.return_btn=null,this.sndBtn=null,this.musicBtn=null},e}(eui.Component);__reflect(BairenNiuniuGround.prototype,"BairenNiuniuGround",["eui.UIComponent","egret.DisplayObject"]);var DoorGroup=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._doorId=0,e._totalCoinNum=0,e}return __extends(e,t),e.prototype.selected=function(){this.selectLogo.visible=!this.selectLogo.visible},Object.defineProperty(e.prototype,"doorId",{get:function(){return this._doorId},set:function(t){this._doorId=t},enumerable:!0,configurable:!0}),e.prototype.addCoin=function(t){this._totalCoinNum+=t,this.totalXiaZhu_txt.text="总："+this._totalCoinNum;var e=new eui.Image;e.source=RES.getRes("BRNN_Battle_json.BRNN_weight_"+t),this.coin_container.addChild(e);var n=this.coin_container.width-1.5*e.width,a=this.coin_container.height-1.5*e.height;e.x=Math.floor(Math.random()*n),e.y=Math.floor(Math.random()*a)},e.prototype.clear=function(){this.coin_container.removeChildren(),this.nowXiaZhu_txt.visible=!1,this._totalCoinNum=0,this.totalXiaZhu_txt.text="总："+this._totalCoinNum,this.cardGroup.visible=!1,this.cardGroup.reset()},e}(eui.Component);__reflect(DoorGroup.prototype,"DoorGroup",["eui.UIComponent","egret.DisplayObject"]);var HeadGroup=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(eui.Component);__reflect(HeadGroup.prototype,"HeadGroup",["eui.UIComponent","egret.DisplayObject"]);var RankHeadGroup=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(eui.Component);__reflect(RankHeadGroup.prototype,"RankHeadGroup",["eui.UIComponent","egret.DisplayObject"]);var CardGroup=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.hideEndCard=function(){this.card_4.visible=!1},e.prototype.showEndCard=function(){this.card_4.source=RES.getRes("niuniu_card_json.card_back"),this.card_4.visible=!0},e.prototype.showBgCard=function(t){for(var e=0;e<t.cardList.length;e++){var n=this["card_"+e];n.visible=!0,n.source=RES.getRes("niuniu_card_json.card_back")}},e.prototype.showCard=function(t){for(var e=0;e<t.cardList.length;e++){var n=this["card_"+e];n.visible=!0,n.source=RES.getRes(t.cardList[e].value+"")}},e}(eui.Component);__reflect(CardGroup.prototype,"CardGroup",["eui.UIComponent","egret.DisplayObject"]);var Zhuangjia=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.showZhuangJia=function(){this.zhuangJia_logo.visible=!0},e.prototype.hideZhuangJia=function(){this.zhuangJia_logo.visible=!1},e}(eui.Component);__reflect(Zhuangjia.prototype,"Zhuangjia",["eui.UIComponent","egret.DisplayObject"]);var NiuniuBattle=function(t){function e(e){var n=t.call(this)||this;return n._waitCount=0,n._isSendOver=!1,n._nowSeatNo=999,n.seatObj={},n.zhuangJiaScoreObj={},n._channel=e,n._player=Player.instance,n._timer=new egret.Timer(1e3),n}return __extends(e,t),e.prototype.init=function(){this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["niuniubattle_snd_mp3"]),this.findTxt=AnimateManager.instance.createDragonBones(egret.MainContext.instance.stage,"Loading_ske_json","Loading_tex_json","Loading_tex_png").display,this.findTxt.x=ConfigData.stageWidth/2,this.findTxt.y=ConfigData.stageHeight/2},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addListener(),this.currentTime_txt.text=""},e.prototype.addListener=function(){this.no_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score1_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score2_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score3_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score4_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score5_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.score10_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.score15_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.score20_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.score25_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this)},e.prototype.removeListener=function(){this.no_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score1_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score2_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score3_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score4_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.qiangZhuangFunc,this),this.score5_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.score10_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.score15_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.score20_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this),this.score25_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.xiaZhufunc,this)},e.prototype.qiangZhuangFunc=function(t){this.qz_btn_group.visible=!1;var e=+t.target.name,n={type:e};ProtoRegister.Ins.setMessage(NetCommands.NIUNIU_DO_GRAB,n)},e.prototype.xiaZhufunc=function(t){this.xiazhu_btn_group.visible=!1;var e=+t.target.name,n={crit:e};ProtoRegister.Ins.setMessage(NetCommands.NIUNIU_ROLE_XIAZHU,n)},e.prototype.matchPlayers=function(){var t={type:1};ProtoRegister.Ins.setMessage(NetCommands.NIUNIU_MATCH,t)},e.prototype.roomRoleChange=function(t){var e=this._player.roleRoomList,n=[],a=[];for(var i in this.seatObj)n.push(this.seatObj[i]);for(var o=1;this["player_group_"+o];)n.indexOf(o)<0&&a.push(o),o++;for(var s,r=0;r<e.length;r++){var _=e[r],i=_.roleId;if(!this.seatObj.hasOwnProperty(i+"")){i!=this._player.roleId?(this.seatObj[i]=a.shift(),s=this["player_group_"+this.seatObj[i]]):(this.seatObj[i]=0,s=this.player_group_0),s.visible=!0;var h=s.getChildByName("tip_state");h.visible=!0,h.source=RES.getRes("niuniukaiju_json.nn_ready_1")}}t instanceof com.protobuff.data.NiuNiuEnterRoomModule&&(this._waitCount=t.waittime,this._timer.addEventListener(egret.TimerEvent.TIMER,this.onStartGroudTimer,this),this._timer.start())},e.prototype.onStartGroudTimer=function(){if(!(this._waitCount<=0)){this.currentTime_txt.visible=!0;var t=this._waitCount>9?"开局倒计时：":"开局倒计时：0";this.currentTime_txt.text=t+this._waitCount,this._waitCount--}},e.prototype.onScoreChange=function(t){t instanceof com.protobuff.data.NiuNiuRoomCritModule&&(this._player.timesNum=t.crit),this.showState(t)},e.prototype.showState=function(t){var e=t.roleId,n=this["player_group_"+this.seatObj[e]];if(n){var a=n.getChildByName("beishu_state");a.visible=!0,t instanceof com.protobuff.data.NiuNiuRoleGrabModule?(a.source=RES.getRes("niuniukaiju_json.x_"+t.type+"x"),this.zhuangJiaScoreObj[e]=t.type):t instanceof com.protobuff.data.NiuNiuRoleAddCritModule&&(a.source=RES.getRes("niuniukaiju_json.x_"+t.crit+"x"))}},e.prototype.setCard=function(t){var e=this;if(1==t.isFirst){this.currentTime_txt.text="",this.currentTime_txt.visible=!1,this._timer.stop(),this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onStartGroudTimer,this);for(var n=0;n<this._player.roleRoomList.length;n++){var a=this["player_group_"+n],i=a.getChildByName("tip_state");i.visible=!1}}this.findTxt.visible=!1;for(var o=1==t.isFirst?4:1,s=new egret.Point(ConfigData.stageWidth/2,ConfigData.stageHeight/2),r=function(n){var a=new egret.Point(_["player_group_"+n].x,_["player_group_"+n].y);setTimeout(function(){EffectManager.instance.fromToEffect(egret.MainContext.instance.stage,s,a,o,500,"niuniu_card_json.card_back",60,e.showCard.bind(e,n,t))},400*n)},_=this,n=0;n<this._player.roleRoomList.length;n++)r(n)},e.prototype.showCard=function(t,e){void 0===t&&(t=0);var n=this["player_group_"+t];if(0==t)if(1==e.isFirst)for(var a=0;a<e.cardList.length;a++){var i=this["card_"+a];i.visible=!0,i.source=RES.getRes(e.cardList[a].value+"")}else{var i=this.card_4;i.visible=!0,i.source=RES.getRes(e.cardList[0].value+"")}else{var o=n.getChildByName("cardGroup");1==e.isFirst?(o.visible=!0,o.showBgCard(e)):o.showEndCard()}},e.prototype.returnGround=function(){this._timer&&this._timer.stop(),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.NIUNIU_GROUND_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.NIUNIU_BATTLE_VIEW])},e.prototype.closeMatchTimer=function(){this._timer&&(this._timer.stop(),this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this))},e.prototype.onTimer=function(t){this._count--,this._count<=0&&(this.closeMatchTimer(),this.findTxt.visible=!1,this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.MATCH_END_VIEW,0,0,ConstData.UI_LAYER]))},e.prototype.onMatchPlayerBack=function(t){this.clear(),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.MATCH_END_VIEW]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_ONCE,["start_snd_mp3"]);var e=new Object;for(var n in t.PlayerIndexIdDic){var a=n.slice(0,4)+"..."+n.slice(n.length-4,n.length);e[t.PlayerIndexIdDic[n]]=a}this.setBalance(),this.findTxt.visible=!1},e.prototype.setFinishFunc=function(t,e){void 0===e&&(e=0),this._finishFunc=null,t==this._player.seatNo&&0==e&&this._player.curCards.type==CARD_TYPE.NO_CARDS},e.prototype.grabLandLordSuccess=function(t){var e=this,n=t.landId;this._player.landId=n;var a=this.zhuangJiaScoreObj[n],i=[];for(var o in this.zhuangJiaScoreObj)this.zhuangJiaScoreObj[o]==a&&i.push(o);if(i.length>1){for(var s=[],r=0;r<i.length;r++){var o=i[r],_=this["player_group_"+this.seatObj[o]],h=_.getChildByName("zhuangJia"),l=AnimateManager.instance.createDragonBones(h,"niuniu_flash_ske_json","niuniu_flash_tex_json","niuniu_flash_tex_png"),c=l.display;c.x=h.width/2,c.y=h.height/2-4,s.push(l)}setTimeout(function(){for(var t=0;t<s.length;t++){var a=s[t];a.dispose(),a.display.parent.removeChild(a.display)}var i=e["player_group_"+e.seatObj[n]],o=i.getChildByName("zhuangJia");o.showZhuangJia()},2500)}else{var d=this["player_group_"+this.seatObj[n]],h=d.getChildByName("zhuangJia");h.showZhuangJia()}},e.prototype.jiaoZhuang=function(t){this.qz_btn_group.visible=!0},e.prototype.xiaZhu=function(t){this._player.isLand||(this.xiazhu_btn_group.visible=!0)},e.prototype.jiesuan=function(t){for(var e=[],n=0;n<t.roleList.length;n++){var a=t.roleList[n];a.roleId!=this._player.roleId&&e.push(a);var i=this["player_group_"+this.seatObj[a.roleId]],o=i.getChildByName("result_state");o.visible=!0;var s=a.niuniuCardType,r="";switch(s){case 0:r="mn";break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:r="n0"+s;break;case 10:r="n00";break;case 11:r="n4hn";break;case 12:r="n5hn"}o.source=RES.getRes("niuniukaiju_json.nn_"+r)}for(var _=this["player_group_"+this.seatObj[this._player.landId]],h=_.getChildByName("zhuangJia"),l=h.localToGlobal(h.x,h.y),n=0;n<e.length;n++){var a=e[n],c=this["player_group_"+this.seatObj[a.roleId]],d=c.getChildByName("cardGroup");d.showCard(a)}for(var n=0;n<t.roleList.length;n++){var a=t.roleList[n];if(a.roleId!=this._player.landId){var c=this["player_group_"+this.seatObj[a.roleId]],u=c.getChildByName("zhuangJia"),C=u.localToGlobal(u.x,u.y);a.settleResult?EffectManager.instance.fromToEffect(egret.MainContext.instance.stage,l,C,10,900,"niuniukaiju_json.gold",20):EffectManager.instance.fromToEffect(egret.MainContext.instance.stage,C,l,10,900,"niuniukaiju_json.gold",20)}}this.nextRound();for(var p in this.zhuangJiaScoreObj)delete this.zhuangJiaScoreObj[p];for(var p in this.seatObj)delete this.zhuangJiaScoreObj[p]},e.prototype.setBalance=function(){var t=parseFloat(this._player.gold);parseInt(t.toString().split(".")[0])},e.prototype.nextRound=function(){this._timer.addEventListener(egret.TimerEvent.TIMER,this.onNextGroudTimer.bind(this),this),this._count=5},e.prototype.onNextGroudTimer=function(){if(this._count--,0==this._count){for(var t={status:1},e=(ProtoRegister.Ins.setMessage(NetCommands.NIUNIU_PREPARE,t),0);e<this._player.roleRoomList.length;e++){var n=this["player_group_"+e],a=n.getChildByName("beishu_state");a.visible=!1;var i=n.getChildByName("result_state");i.visible=!1;var o=n.getChildByName("tip_state");if(o.visible=!0,o.source=RES.getRes("niuniukaiju_json.nn_ready_1"),0!=e){var s=n.getChildByName("cardGroup");s.hideEndCard(),s.visible=!1}var r=n.getChildByName("zhuangJia");r.hideZhuangJia()}this.card_0.visible=!1,this.card_1.visible=!1,this.card_2.visible=!1,this.card_3.visible=!1,this.card_4.visible=!1,this._timer.removeEventListener(egret.TimerEvent.TIMER,this.onNextGroudTimer.bind(this),this)}},e.prototype.reconGame=function(t){},e.prototype.invaild=function(){this.clear(),this.returnGround(),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["对局无效，返回大厅"])},e.prototype.clear=function(){},e}(eui.Component);__reflect(NiuniuBattle.prototype,"NiuniuBattle",["eui.UIComponent","egret.DisplayObject"]);var NiuNiuCards=function(){function t(){}return t.getOneCardName=function(t){var e=t/100,n=t%100,a="";switch(e){case 1:a+="方块";break;case 2:a+="梅花";break;case 3:a+="红桃";break;case 4:a+="黑桃"}switch(n){case 1:a+="A";break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:a+=n;break;case 11:a+="J";break;case 12:a+="Q";break;case 13:a+="K"}return a.toString()},t.subCards=function(t,e){if(null==e)return t;var n=t;for(var a in e)n=this.removeOne(n,e[a]);return n},t.removeOne=function(t,e){for(var n=t,a=0;a<t.length;a++)if(t[a]==e){n.splice(a,1);break}return n},t.isSmallNiu=function(t){for(var e=0,n=0;n<t.length;n++){var a=t[n];if(a%100>=5)return!1;var i=a%100;e+=i}return e>=10?!1:!0},t.isBomb=function(t){try{for(var e=this.getValueCards(t),n=e.length,a=0;n-3>a;a++){for(var i=1,o=t[a]%100,s=a+1;n>s;s++)t[s]==o&&i++;if(i>=4)return!0}return!1}catch(r){return console.error(r),!1}},t.getValueCards=function(t){for(var e=new Array,n=0;n<t.length;n++){var a=t[n]%100;e.push(a)}return e},t.isFiveFlowerNiu=function(t){for(var e=0,n=0;n<t.length;n++){var a=t[n],i=a%100;i>=11&&13>=i&&e++}return 5==e?!0:!1},t.isFourFlowerNiu=function(t){for(var e=0,n=0;n<t.length;n++){var a=t[n],i=a%100;i>=11&&13>=i&&(e++,t=this.subCards(t,[a]))}return 4==e&&t[0]%100==10?!0:!1},t.isSmallestNiu=function(t){for(var e=0,n=0;n<t.length;n++){var a=t[n];100>a&&e++}return 5==e?!0:!1},t.getCardsLevel=function(t){if(this.isSmallNiu(t))return this.setNiuNiuLevelBean(14,NiuNiuLevel.FIVE_SMALL_NIU_ODD,t);if(this.isBomb(t))return this.setNiuNiuLevelBean(13,NiuNiuLevel.FIVE_SMALL_NIU_ODD,t);if(this.isFiveFlowerNiu(t))return this.setNiuNiuLevelBean(12,NiuNiuLevel.FIVE_FLOWER_NIU_ODD,t);if(this.isFourFlowerNiu(t))return this.setNiuNiuLevelBean(11,NiuNiuLevel.FOUR_FLOWER_NIU_ODD,t);if(this.isSmallestNiu(t))return this.setNiuNiuLevelBean(10,NiuNiuLevel.NIU_NIU_ODD,t);var e=this.getNiu(t);switch(e){case 0:case 1:case 2:case 3:case 4:case 5:case 6:return this.setNiuNiuLevelBean(e,NiuNiuLevel.UNDER_SEVEN_NIU_ODD,t);case 7:case 8:case 9:return this.setNiuNiuLevelBean(e,NiuNiuLevel.NIU_SEVEN_TO_NINE_ODD,t);case 10:return this.setNiuNiuLevelBean(e,NiuNiuLevel.NIU_NIU_ODD,t)}return null},t.getNiu=function(t){var e=0,n=0,a=!1,i=this.getNiuCards(t);if(i.length>0&&(a=!0),a){for(var o=0;o<t.length;o++){var s=t[o];e+=10>s%100?s%100:10}return n=e%10==0?10:e%10}return 0},t.setNiuNiuLevelBean=function(t,e,n){var a=new NiuNiuLevel;a.setLevel(t),a.setOdds(e);var i=this.getMaxCard(n);return 100>i?(a.setBigColor(0),a.setBigCard(0)):(a.setBigColor(i/100),a.setBigCard(i%100)),a},t.getMaxCard=function(t){for(var e=[],n=0;n<t.length;n++){var a=t[n];e.push(a)}return e.sort(function(t,e){return e>t?1:-1}),e[0]},t.sort=function(t){for(var e,n=t.length,a=0;n-1>a;a++)for(var i=a+1;n>i;i++)t[a]>t[i]&&(e=t[a],t[a]=t[i],t[i]=e)},t.getNiuCards=function(t){for(var e=[],n=0;n<t.length;n++)for(var a=0;a<t.length;a++)for(var i=0;i<t.length;i++)if(t[n]!=t[a]&&t[n]!=t[i]&&t[a]!=t[i]&&(this.getCardValue(t[n])+this.getCardValue(t[a])+this.getCardValue(t[i]))%10==0){var o=[t[n],t[a],t[i]];e.concat(o)}return e},t.getCardValue=function(t){return t%100>10?10:t%100},t.convertSortCardToString=function(t){var e="";if(this.isSmallNiu(t)||this.isFiveFlowerNiu(t)||this.isFourFlowerNiu(t)||this.isBomb(t)||0==this.getCardsLevel(t).getLevel()){for(var n=[],a=0;a<t.length;a++)n.push(t[a]);this.sortCardList(n);for(var a=0;a<n.length;a++)e+=n[a],a!=n.length-1&&(e+="|")}else{for(var i=this.getNiuCards(t)[0],o=this.subCards(t,i),s=[],r=[],a=0;a<i.length;a++)s.push(a);for(var a=0;a<o.length;a++)r.push(a);this.sortCardList(s),this.sortCardList(r);for(var a=0;a<s.length;a++)e+=a+"|";for(var a=0;a<r.length;a++)e+=r[a],a!=r.length-1&&(e+="|")}return e},t.sortCardList=function(t){t.sort(function(t,e){return e%100>t%100?1:t%100>e%100?-1:e/100>t/100?1:-1})},t.main=function(t){var e=[212,311,208,301,201],n=this.getCardsLevel(e);console.log(n.getLevel())},t.allCards=new Array(101,102,103,104,105,106,107,108,109,110,111,112,113,201,202,203,204,205,206,207,208,209,210,211,212,213,301,302,303,304,305,306,307,308,309,310,311,312,313,401,402,403,404,405,406,407,408,409,410,411,412,413),t}();__reflect(NiuNiuCards.prototype,"NiuNiuCards");var NiuniuGround=function(t){function e(e){var n=t.call(this)||this;return n.ekt=0,n._isGame=!1,n._tapTime=0,n._tapNum=0,n._channel=e,n}return __extends(e,t),e.prototype.init=function(){document.bgColor="#0d1b51",this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_MUSIC,["niuniu_ground_snd_mp3"]),this.sndBtn&&(this.sndBtn.selected=this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_GET_PLAY_SND)),this.musicBtn&&(this.musicBtn.selected=this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_GET_PLAY_MUSIC))},e.prototype.setEktTxt=function(t){if(this.ekt=t,this.ekt_txt){var e=parseInt(t.toString().split(".")[0]),n=void 0;e>1e4?(n=(e/1e4).toFixed(2)+"万",this.ekt_txt.text=n):this.ekt_txt.text=parseFloat(t)+""}},e.prototype.checkInGame=function(t){var e=this;this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._finishFuc=t,this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_WAIT,"正在进入游戏..."),setTimeout(function(){e._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT)},1500)},e.prototype.onComplete=function(t){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_WAIT);var e=JSON.parse(t.target.data);1==e.result?(this._isGame=!0,this._finishFuc&&this._finishFuc(),this._finishFuc=null):this._isGame=!1},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n);n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){var n=this;switch(e){case"primary":this.checkInGame(function(){n.selectBattle(2,48,37)});break;case"middle":this.checkInGame(function(){n.selectBattle(10,240)});break;case"high":this.checkInGame(function(){n.selectBattle(50,1200,780)});break;case"return_btn":this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.HALL_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.GROUND_VIEW]);break;case"recharge_btn":this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.RECHARGE_VIEW,0,0,ConstData.UI_LAYER]);break;case"cash_btn":this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.CASH_VIEW,0,0,ConstData.UI_LAYER]);break;case"snd_btn":this.sndBtn.selected=!this.sndBtn.selected,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_IS_PLAY_SND,this.sndBtn.selected);break;case"music_btn":this.musicBtn.selected=!this.musicBtn.selected,this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_PLAY_POKER,["btn_click_snd_mp3"]),this._channel.postCommand(ConstData.SOUND_CONTROLLER,ConstData.SOUND_IS_PLAY_MUSIC,this.musicBtn.selected);break;case"fast_play_btn":this.enterGame_Now(2,48)}},this)},e.prototype.enterGame_Now=function(t,e){this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{baseNum:t}),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.NIUNIU_BATTLE_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.NIUNIU_GROUND_VIEW]),this._channel.postCommand(ConstData.NIUNIU_BATTLE_CONTROLLER,ConstData.BATTLE_NIU_MATCH_PLAYERS)},e.prototype.selectBattle=function(t,e,n){if(void 0===n&&(n=-1),this.ekt<e&&!ConfigData.DEBUG&&!this._isGame)return this._tapNum>3?void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请检查您的网络是否断开",500]):void this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["您的金额不足",500,n]);var a=new Date,i=a.getTime();return i-this._tapTime<1e3?void(this._tapTime=i):(this._tapNum++,this._tapNum>3&&this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_ADD_TIP,["请检查您的网络是否断开",500]),this._tapTime=i,void this.enterGame(t,e))},e.prototype.enterGame=function(t,e){this._channel.postCommand(ConstData.GAME_CONTROLLER,ConstData.GAME_SET_PLAYER,{baseNum:t}),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.NIUNIU_BATTLE_VIEW,0,0,ConstData.UI_LAYER]),this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_REMOVE_VIEW_BY_NAME,[ConstData.NIUNIU_GROUND_VIEW]),this._channel.postCommand(ConstData.BATTLE_CONTROLLER,ConstData.BATTLE_NIU_MATCH_PLAYERS)
},e.prototype.addSpark=function(t){if(t){var e=t.getChildByName("spark");if(!e){var n=new egret.Sprite;e=new egret.Bitmap(RES.getRes("spark_png")),n.width=e.width,n.height=e.height,n.graphics.beginFill(0),n.graphics.drawRoundRect(20,37,284,406,20,20),n.graphics.endFill(),t.addChild(n),e.mask=n,e.name="spark",e.alpha=.2,e.blendMode=egret.BlendMode.ADD,t.addChild(e)}var a=e.width,i=e.height,o=Math.atan2(a,i),s=Math.sin(o)*Math.cos(o)*i,r=Math.sin(o)*Math.sin(o)*i;e.x=-s,e.y=r,egret.Tween.get(e,{loop:!0}).to({x:s+50,y:-r-50},1350).wait(2e3).to({x:-s,y:r},0)}},e.prototype.removeSparkTween=function(t){var e=t.getChildByName("spark");e&&egret.Tween.removeTweens(e)},e.prototype.childrenCreated=function(){this.tip_btn.touchEnabled=!0,t.prototype.childrenCreated.call(this),this.addSpark(this.primary),this.addSpark(this.middle),this.addSpark(this.high),this.tip_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tipFunc,this)},e.prototype.tipFunc=function(){this._channel.postCommand(ConstData.UI_CONTROLLER,ConstData.UI_SHOW_VIEW_BY_NAME,[ConstData.GAME_RULE_VIEW,0,0,ConstData.UI_LAYER])},e.prototype.removeView=function(){this._tapNum=0},e.prototype.destroy=function(){this.removeView(),this._channel=null,this.ekt_txt=null,this.primary=null,this.middle=null,this.high=null,this.return_btn=null,this.sndBtn=null,this.musicBtn=null},e}(eui.Component);__reflect(NiuniuGround.prototype,"NiuniuGround",["eui.UIComponent","egret.DisplayObject"]);var NiuNiuLevel=function(){function t(){}return t.prototype.setLevel=function(t){this.level=t},t.prototype.setOdds=function(t){this.odds=t},t.prototype.setBigColor=function(t){this.bigColor=t},t.prototype.setBigCard=function(t){this.bigCard=t},t.prototype.getLevel=function(){return this.level},t.cardsType=["无牛","牛一","牛二","牛三","牛四","牛五","牛六","牛七","牛八","牛九","牛牛","四花","五花","炸弹","小牛牛"],t.FIVE_SMALL_NIU_ODD=10,t.BOMB_NIU_ODD=7,t.FIVE_FLOWER_NIU_ODD=5,t.FOUR_FLOWER_NIU_ODD=4,t.NIU_NIU_ODD=3,t.NIU_SEVEN_TO_NINE_ODD=2,t.UNDER_SEVEN_NIU_ODD=1,t}();__reflect(NiuNiuLevel.prototype,"NiuNiuLevel");var NiuniuLoadingView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var t=AnimateManager.instance.createDragonBones(this,"qznn_loading_ske_json","qznn_loading_tex_json","qznn_loading_tex_png",function(){t.dispose()}),e=t.display;e.x=this.loading_ani_point.x,e.y=this.loading_ani_point.y},e.prototype.onProgress=function(t,e){this.loading_txt.text="正在加载 ..."+t+"/"+e,t==e&&this.destroy()},e.prototype.destroy=function(){this.parent.removeChild(this),this.loading_txt=null},e}(eui.Component);__reflect(NiuniuLoadingView.prototype,"NiuniuLoadingView",["RES.PromiseTaskReporter","eui.UIComponent","egret.DisplayObject"]);